{"version":3,"sources":["webpack:///src/app/tab3/tab3.page.html","webpack:///src/app/tab3/tab3-routing.module.ts","webpack:///src/app/tab3/tab3.module.ts","webpack:///src/app/tab3/tab3.page.scss","webpack:///src/app/tab3/tab3.page.ts"],"names":["routes","path","component","Tab3PageRoutingModule","imports","forChild","exports","Tab3PageModule","declarations","Tab3Page","listingService","afauth","nacCtrl","afstore","changeDetection","alertCtrl","cart","subtotal","isReady","self","onAuthStateChanged","user","userUID","uid","items","doc","userItems","valueChanges","initializeItems","retailers","getUsers","filter","currentUser","isRetailer","detectChanges","getCart","currentListing","get","toPromise","then","querySnapshot","cart1","forEach","element","push","totalPrice","error","console","log","item","presentAlertDelete","confirm","update","FieldValue","arrayRemove","description","listingID","retailerUID","quantity","quantityCart","price","toLowerCase","promise","Promise","resolve","resolveFunction","create","header","message","buttons","text","handler","alert","present","quantityValue","priceValue","arrayUnion","find","name","presentAlertCheck","navigateRoot","selector","template"],"mappings":"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","file":"tab3-tab3-module-es5.js","sourcesContent":["export default \"<ion-header style=\\\"text-align: center\\\">\\n  <ion-toolbar mode=\\\"ios\\\" color=\\\"primary\\\">\\n    <ion-title>Good Food</ion-title>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-menu-button autoHide=\\\"true\\\"></ion-menu-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content fullscreen [hidden]=\\\"!isReady\\\">\\n  <div *ngFor=\\\"let item of cart\\\">\\n    <ion-card>\\n     <ion-item>\\n      <ion-card-title class=\\\"ion-text-wrap\\\">{{getRetailer(item.retailerUID)}}</ion-card-title>\\n      <ion-button  (click)=\\\"delete(item)\\\" fill=\\\"outline\\\" slot=\\\"end\\\">Delete</ion-button> \\n    </ion-item>\\n   \\n     <ion-card-content> \\n        <p style=\\\"font-size: large;\\\" > Quantity: \\n          <ion-button (click)=\\\"dec(item)\\\" size=\\\"small\\\" fill=\\\"clear\\\"> \\n            <ion-icon name=\\\"remove-circle-outline\\\"></ion-icon> \\n          </ion-button>\\n          {{item.quantityCart}}\\n          <ion-button (click)=\\\"inc(item)\\\" size=\\\"small\\\" fill=\\\"clear\\\"> \\n            <ion-icon name=\\\"add-circle-outline\\\"></ion-icon> \\n          </ion-button></p>\\n          <p style=\\\"font-size: large;\\\"> Price: ${{item.totalPrice | number:'1.2-2'}}</p>\\n     </ion-card-content>\\n   </ion-card>\\n  </div>\\n  <ion-text class=\\\"centerText\\\" *ngIf=\\\"((userItems | async)?.cart).length <= 0\\\" color=\\\"primary\\\" style=\\\"text-align: center\\\">\\n      <p>There are no items in the cart.</p>\\n  </ion-text>  \\n</ion-content>\\n\\n<ion-footer *ngIf=\\\"((userItems | async)?.cart).length > 0\\\" >\\n  <!-- class=\\\"ion-no-border\\\" -->\\n \\n  <ion-toolbar *ngIf=\\\"userItems | async as cartData\\\"  position=\\\"bottom\\\" style=\\\"text-align: center;\\\">\\n    <div class=\\\"ion-text-end\\\" id=\\\"subtotal\\\">\\n      <ion-text > <p style=\\\"font-size: large;\\\"> Subtotal: ${{subtotal | number:'1.2-2'}} </p></ion-text> \\n    </div>     \\n    <ion-button expand=\\\"block\\\" (click)=\\\"checkOut(cartData.cart)\\\" size=\\\"large\\\">Checkout</ion-button>\\n </ion-toolbar>\\n</ion-footer>\\n\";","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { Tab3Page } from './tab3.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: Tab3Page,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class Tab3PageRoutingModule {}\n","import { IonicModule } from '@ionic/angular';\nimport { RouterModule } from '@angular/router';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Tab3Page } from './tab3.page';\n\nimport { Tab3PageRoutingModule } from './tab3-routing.module'\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    RouterModule.forChild([{ path: '', component: Tab3Page }]),\n    Tab3PageRoutingModule,\n  ],\n  declarations: [Tab3Page]\n})\nexport class Tab3PageModule {}\n","export default \".large {\\n  font-size: 1500%;\\n}\\n\\n.centerText {\\n  height: 90% !important;\\n  display: flex !important;\\n  align-items: center !important;\\n  justify-content: center !important;\\n  align-content: center !important;\\n  flex-wrap: wrap !important;\\n}\\n\\n#subtotal {\\n  padding-right: 2%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdGFiMy90YWIzLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGdCQUFBO0FBQ0o7O0FBRUE7RUFDSSxzQkFBQTtFQUNBLHdCQUFBO0VBQ0EsOEJBQUE7RUFDQSxrQ0FBQTtFQUNBLGdDQUFBO0VBQ0EsMEJBQUE7QUFDSjs7QUFFQztFQUNHLGlCQUFBO0FBQ0oiLCJmaWxlIjoic3JjL2FwcC90YWIzL3RhYjMucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmxhcmdle1xuICAgIGZvbnQtc2l6ZTogMTUwMCU7XG59XG5cbi5jZW50ZXJUZXh0IHtcbiAgICBoZWlnaHQ6IDkwJSAhaW1wb3J0YW50O1xuICAgIGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDtcbiAgICBhbGlnbi1pdGVtczogY2VudGVyICFpbXBvcnRhbnQ7XG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXIgIWltcG9ydGFudDtcbiAgICBhbGlnbi1jb250ZW50OiBjZW50ZXIhaW1wb3J0YW50O1xuICAgIGZsZXgtd3JhcDogd3JhcCAhaW1wb3J0YW50OyAgICBcbiB9XG5cbiAjc3VidG90YWx7XG4gICAgcGFkZGluZy1yaWdodDogMiU7XG4gfVxuXG4iXX0= */\";","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { AngularFirestore } from '@angular/fire/firestore';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { AlertController, NavController } from '@ionic/angular';\nimport * as firebase from 'firebase/app';\nimport { ListingsService} from '../listings.service';\n\n@Component({\n  selector: 'app-tab3',\n  templateUrl: 'tab3.page.html',\n  styleUrls: ['tab3.page.scss']\n})\nexport class Tab3Page implements OnInit{\n  userUID;\n  userItems;\n  items;\n  cart = [];\n  listing;\n  name;\n  description;\n  location;\n  price;\n  quantity;\n  retailerType;\n  retailerUID;\n  date: Date;\n  subtotal = 0;\n  isReady = false;\n  retailers: any[];\n\n  constructor(public listingService: ListingsService, public afauth: AngularFireAuth, private nacCtrl: NavController, public afstore: AngularFirestore, private changeDetection: ChangeDetectorRef, public alertCtrl: AlertController) {}\n\n  ngOnInit() { \n    var self = this\n    this.cart = []\n    this.subtotal = 0;\n    this.afauth.onAuthStateChanged(async function(user) {        \n      if (user) {        \n        self.userUID = user.uid\n        self.items = self.afstore.doc(`users/${self.userUID}`);\n        self.userItems = self.items.valueChanges();\n        await self.listingService.initializeItems();\n        self.retailers = self.listingService.getUsers().filter(currentUser => {\n          if (currentUser.isRetailer) {\n            return (currentUser.isRetailer);\n          }\n        });   \n        self.changeDetection.detectChanges(); \n        self.getCart();  \n\n      }\n    });    \n  }\n\n  async ionViewWillEnter(){\n    this.cart = []\n    this.subtotal = 0;\n    if(this.items){\n      this.userItems = this.items.valueChanges();\n      await this.listingService.initializeItems();\n      this.retailers = this.listingService.getUsers().filter(currentListing => {\n        if (currentListing.isRetailer) {\n          return (currentListing.isRetailer);\n        }\n      }); \n      this.getCart();\n      this.changeDetection.detectChanges(); \n\n      \n    }    \n  }\n\n  async getCart(){    \n    var self = this;\n    await this.afstore.doc(`users/${this.userUID}`).get().toPromise().then(function(querySnapshot) {\n      self.cart = []\n      self.subtotal = 0\n      var cart1 = querySnapshot.get(\"cart\");\n      self.changeDetection.detectChanges(); \n      cart1.forEach(element => {\n        self.cart.push(element);  \n        self.subtotal += element.totalPrice          \n        });            \n    })\n    .catch(function(error) {\n        console.log(\"Error getting documents\");\n    }); \n\n    this.changeDetection.detectChanges();  \n    this.isReady = true;   \n  }\n\n  async delete(item){\n\n    const confirm = await this.presentAlertDelete();\n    if (confirm) {\n    this.afstore.doc(`users/${this.userUID}`).update({\n      cart: firebase.firestore.FieldValue.arrayRemove({\n        description: item.description,\n        listingID: item.listingID,\n        retailerUID: item.retailerUID,\n        quantity: item.quantity,\n        quantityCart: item.quantityCart,\n        price: item.price,\n        totalPrice: item.totalPrice\n      })\n    })\n    this.cart = this.cart.filter(currentListing => {\n      if (currentListing.listingID && item.listingID) {\n        return (!(currentListing.listingID.toLowerCase() === item.listingID.toLowerCase()));\n      }\n    }); \n    this.subtotal -= item.totalPrice; \n  }\n  }\n\n  async presentAlertDelete() : Promise<boolean> {\n    let resolveFunction: (confirm: boolean) => void;\n    const promise = new Promise<boolean>(resolve => {\n      resolveFunction = resolve;\n    });\n    const alert = await this.alertCtrl.create({\n      header: 'Confirm Delete',\n      message: 'Are you sure you want to delete this item from your cart?',\n      buttons: [\n        {\n          text: 'Yes',\n            handler: () => resolveFunction(true)\n        }, {\n          text: 'No',\n          handler: () => resolveFunction(false)\n        }\n      ]\n    });\n\n    await alert.present();\n    return promise;\n  }\n\n  inc(item){   \n    if(item.quantityCart + 1 <= item.quantity){\n\n      var quantityValue = item.quantityCart + 1; \n      var priceValue = item.totalPrice + item.price;\n\n      this.afstore.doc(`users/${this.userUID}`).update({\n        cart: firebase.firestore.FieldValue.arrayUnion({\n          description: item.description,\n          listingID: item.listingID,\n          retailerUID: item.retailerUID,\n          quantity: item.quantity,\n          quantityCart: quantityValue,\n          price: item.price,\n          totalPrice: priceValue\n        })\n      })\n  \n      this.afstore.doc(`users/${this.userUID}`).update({\n        cart: firebase.firestore.FieldValue.arrayRemove({\n          description: item.description,\n          listingID: item.listingID,\n          retailerUID: item.retailerUID,\n          quantity: item.quantity,\n          quantityCart: item.quantityCart,\n          price: item.price,\n          totalPrice: item.totalPrice\n        })\n      })\n      item.quantityCart++;\n      item.totalPrice += item.price;\n      this.subtotal += item.price;\n      \n    }  \n  }\n\n  dec(item){    \n    if(item.quantityCart - 1 > 0){\n      var quantityValue = item.quantityCart - 1;  \n      var priceValue = item.totalPrice - item.price;\n\n      this.afstore.doc(`users/${this.userUID}`).update({\n        cart: firebase.firestore.FieldValue.arrayUnion({\n          description: item.description,\n          listingID: item.listingID,\n          retailerUID: item.retailerUID,\n          quantity: item.quantity,\n          quantityCart: quantityValue,\n          totalPrice: priceValue,\n          price: item.price\n        })\n      })\n  \n      this.afstore.doc(`users/${this.userUID}`).update({\n        cart: firebase.firestore.FieldValue.arrayRemove({\n          description: item.description,\n          listingID: item.listingID,\n          retailerUID: item.retailerUID,\n          quantity: item.quantity,\n          quantityCart: item.quantityCart,\n          price: item.price,\n          totalPrice: item.totalPrice\n        })\n      })\n      item.quantityCart--;\n      item.totalPrice -= item.price;\n      this.subtotal -= item.price;\n    }\n  }\n\n\n  getRetailer(uid) : String{  \n    if(this.retailers){\n     const user = this.retailers.find(element => element.retailerUID == uid);    \n     return user.name;\n\n    }\n  }\n\n  async checkOut(cart){\n    const confirm = await this.presentAlertCheck();\n    if (confirm) {\n      this.nacCtrl.navigateRoot(['./paypal']);\n    }   \n  }\n\n  public async presentAlertCheck() : Promise<boolean> {\n    let resolveFunction: (confirm: boolean) => void;\n    const promise = new Promise<boolean>(resolve => {\n      resolveFunction = resolve;\n    });\n    const alert = await this.alertCtrl.create({\n      header: 'Confirm Check-Out',\n      message: 'Are you sure you want to check out these items from your cart?',\n      buttons: [\n        {\n          text: 'No',\n          handler: () => resolveFunction(false)\n        },\n        {\n          text: 'Yes',\n            handler: () => resolveFunction(true)\n        }\n      ]\n    });\n\n    await alert.present();\n    return promise;\n  }\n}\n"]}