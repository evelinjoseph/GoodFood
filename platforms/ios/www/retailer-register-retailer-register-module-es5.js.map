{"version":3,"sources":["webpack:///src/app/retailer-register/retailer-register.page.html","webpack:///src/app/retailer-register/retailer-register-routing.module.ts","webpack:///src/app/retailer-register/retailer-register.module.ts","webpack:///src/app/retailer-register/retailer-register.page.scss","webpack:///src/app/retailer-register/retailer-register.page.ts"],"names":["routes","path","component","RetailerRegisterPageRoutingModule","imports","forChild","exports","RetailerRegisterPageModule","declarations","RetailerRegisterPage","nacCtrl","afAuth","afstore","alertController","emailComposer","name","email","password","cpassword","location","city","state","zipcode","retailerType","Error","length","pickupTime","undefined","createUserWithEmailAndPassword","res","doc","user","uid","set","isVerified","isRetailer","retailerUID","listings","orders","Date","Email","send","SecureToken","To","From","Subject","Body","then","message","console","log","presentEmailConfirmation","presentAlertCheck","emailConfirmation","newEmail","to","subject","body","isHtml","isAvailable","available","error","open","navigateRoot","presentAlert","errorMessage","promise","Promise","resolve","resolveFunction","create","header","buttons","text","handler","alert","present","date","toString","selector","template"],"mappings":"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","file":"retailer-register-retailer-register-module-es5.js","sourcesContent":["export default \"<ion-header style=\\\"text-align: center\\\">\\n  <ion-toolbar color=\\\"primary\\\" mode=\\\"ios\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button [text]=\\\"Back\\\" defaultHref=\\\"initial-page\\\"></ion-back-button>\\n    </ion-buttons> \\n    <ion-title>\\n      Registration\\n    </ion-title>     \\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content fullscreen>\\n  <br>\\n  <ion-list>\\n    <ion-item>\\n      <ion-label>Pick Up Time</ion-label>\\n      <ion-datetime display-format=\\\"h:mm A\\\" picker-format=\\\"h:mm A\\\" [(ngModel)]=\\\"pickupTime\\\" (ionChange)=\\\"setPickupTime(this.pickupTime)\\\"></ion-datetime>\\n    </ion-item>\\n    <ion-item>\\n      <ion-label position = \\\"floating\\\">\\n          Name\\n        </ion-label>\\n        <ion-input autocapitalize='sentences' type = \\\"text\\\" [(ngModel)]=\\\"name\\\"></ion-input>\\n    </ion-item>\\n    <ion-item>\\n    <ion-label position = \\\"floating\\\">\\n        Email Address\\n      </ion-label>\\n      <ion-input type = \\\"text\\\" [(ngModel)]=\\\"email\\\"></ion-input>\\n  </ion-item>\\n  <ion-item>\\n    <ion-label position = \\\"floating\\\">\\n        Address Line 1\\n      </ion-label>\\n      <ion-input autocapitalize='sentences' type = \\\"text\\\" [(ngModel)]=\\\"location\\\"></ion-input>\\n  </ion-item>\\n  <ion-item>\\n    <ion-label position = \\\"floating\\\">\\n        City\\n      </ion-label>\\n      <ion-input autocapitalize='sentences' type = \\\"text\\\" [(ngModel)]=\\\"city\\\"></ion-input>\\n  </ion-item>\\n  <ion-item>\\n    <ion-label position = \\\"floating\\\">\\n        State\\n      </ion-label>\\n      <ion-input autocapitalize='sentences' type = \\\"text\\\" [(ngModel)]=\\\"state\\\"></ion-input>\\n  </ion-item>\\n  <ion-item>\\n    <ion-label position = \\\"floating\\\">\\n        Zipcode\\n      </ion-label>\\n      <ion-input type = \\\"text\\\" [(ngModel)]=\\\"zipcode\\\"></ion-input>\\n  </ion-item>\\n  <ion-item>\\n    <ion-label position = \\\"floating\\\">\\n        Retailer Type\\n      </ion-label>\\n      <ion-input autocapitalize='sentences' type = \\\"text\\\" [(ngModel)]=\\\"retailerType\\\"></ion-input>\\n  </ion-item>\\n  \\n  <ion-item>\\n    <ion-label position = \\\"floating\\\">\\n        Password\\n      </ion-label>\\n      <ion-input type=\\\"password\\\" [(ngModel)]=\\\"password\\\"></ion-input>\\n  </ion-item>\\n  <ion-item>\\n    <ion-label position = \\\"floating\\\">\\n      Confirm Password\\n    </ion-label>\\n    <ion-input type=\\\"password\\\" [(ngModel)]=\\\"cpassword\\\"></ion-input>\\n</ion-item>\\n</ion-list>\\n  \\n<div style=\\\"text-align: center\\\">\\n  <br>\\n<ion-button expand=\\\"block\\\" fill=\\\"solid\\\" Size = \\\"large\\\" color=\\\"primary\\\" (click)=\\\"register()\\\">Sign Up</ion-button>\\n</div>\\n</ion-content>\\n\\n\\n\\n\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { RetailerRegisterPage } from './retailer-register.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: RetailerRegisterPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class RetailerRegisterPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { RetailerRegisterPageRoutingModule } from './retailer-register-routing.module';\n\nimport { RetailerRegisterPage } from './retailer-register.page';\n\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RetailerRegisterPageRoutingModule\n  ],\n  declarations: [\n    RetailerRegisterPage\n  ]\n})\nexport class RetailerRegisterPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3JldGFpbGVyLXJlZ2lzdGVyL3JldGFpbGVyLXJlZ2lzdGVyLnBhZ2Uuc2NzcyJ9 */\";","import { Component, OnInit } from '@angular/core';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { AngularFirestore } from '@angular/fire/firestore';\nimport { AlertController, NavController } from '@ionic/angular';\nimport { EmailComposer } from '@ionic-native/email-composer/ngx';\n\ndeclare var Email: any;\n\n\n@Component({\n  selector: 'app-retailer-register',\n  templateUrl: './retailer-register.page.html',\n  styleUrls: ['./retailer-register.page.scss'],\n})\nexport class RetailerRegisterPage implements OnInit {\n  name: string = \"\";\n  email: string = \"\";\n  password: string = \"\";\n  cpassword: string = \"\";\n  location: string = \"\";\n  city: string = \"\";\n  state: string = \"\";\n  zipcode: string = \"\";\n  retailerType: string = \"\";\n  pickupTime; \n\n  constructor(private nacCtrl: NavController, public afAuth: AngularFireAuth, public afstore: AngularFirestore, public alertController: AlertController, public emailComposer: EmailComposer) { }\n\n  ngOnInit() { \n  \n  }\n\n  async register() {\n    \n    try{\n      const { name, email, password, cpassword, location, retailerType} = this\n      if(password !== cpassword){      \n        throw new Error('Passwords Do Not Match');\n      } \n      if(name.length==0){\n        throw new Error('Please Enter a Name');\n      }  \n      if(location.length==0){\n        throw new Error('Please Enter an Address');\n      } \n      if(retailerType.length==0){\n        throw new Error('Please Enter Retailer Type (Restaurant, Food Truck, Cafe)');\n      } \n      if(this.pickupTime == undefined){\n        throw new Error('Please Enter Pickup Time');\n      } \n      \n        const res = await this.afAuth.createUserWithEmailAndPassword(email, password)\n        this.afstore.doc(`users/${res.user.uid}`).set({\n          email,\n          name,\n          isVerified: false,\n          isRetailer: true,\n          retailerUID: res.user.uid,\n          location: this.location + \", \" + this.city + \", \" + this.state + \" \" + this.zipcode,\n          retailerType,\n          listings: [],\n          orders: [],\n          pickupTime: new Date(this.pickupTime)\n        })\n      \n      //https://accounts.google.com/b/0/DisplayUnlockCaptcha\n\n      Email.send({\n        SecureToken : \"c11c8a65-d4f9-45b7-8c2a-61f9c48e0ea7\",\n        To : 'goodfoodinnova@gmail.com',\n        From : 'goodfoodinnova@gmail.com',\n        Subject : \"New Retailer Verification\",\n        Body : 'Hello, please verify retailer: ' + name + ' with email: ' + email + ' and uid: ' + res.user.uid + '. Thank you!'\n      }).then(\n        async message => { \n          if(message == \"OK\"){\n            console.log(message)\n            this.presentEmailConfirmation(\"A message has been sent to ensure your account is verified!\")\n          }\n          else{\n            console.log(\"SMTP.js Error: \" + message)\n              const emailConfirmation = await this.presentAlertCheck();\n\n              if (emailConfirmation) {\n\n              let newEmail = {\n                to: 'goodfoodinnova@gmail.com',\n                subject: 'New Retailer Verification',\n                body: 'Hello, please verify retailer: ' + name + ' with email: ' + email + ' and uid: ' + res.user.uid + '. Thank you!',\n                isHtml: true,\n              }\n\n              this.emailComposer.isAvailable().then((available: boolean) => {\n                if(available) {\n                  console.log(\"isAvailable\");\n                }\n              }).catch((error) => { console.log('EmailComposer Error: ' + error.message) });\n              this.emailComposer.open(newEmail);\n            }\n          }         \n        \n      });    \n      this.nacCtrl.navigateRoot([\"./retailertabs/retailertabs/retailertab1\"])   \n  }catch(error){\n    this.presentAlert(error.message);\n  }\n}\n\npublic async presentAlert(errorMessage) : Promise<boolean> {\n  let resolveFunction: (confirm: boolean) => void;\n  const promise = new Promise<boolean>(resolve => {\n    resolveFunction = resolve;\n  });\n  \n  const alert = await this.alertController.create({\n    header: 'Registration Error',\n    message: errorMessage,\n    buttons: [\n      {\n        text: 'OK',\n          handler: () => resolveFunction(true)\n      }\n    ]\n  });\n\n  await alert.present();\n  return promise;\n}\n\npublic async presentEmailConfirmation(message) : Promise<boolean> {\n  let resolveFunction: (confirm: boolean) => void;\n  const promise = new Promise<boolean>(resolve => {\n    resolveFunction = resolve;\n  });\n  \n  const alert = await this.alertController.create({\n    header: 'Email Confirmation',\n    message: message,\n    buttons: [\n      {\n        text: 'OK',\n          handler: () => resolveFunction(true)\n      }\n    ]\n  });\n\n  await alert.present();\n  return promise;\n}\n\npublic async presentAlertCheck() : Promise<boolean> {\n  let resolveFunction: (confirm: boolean) => void;\n  const promise = new Promise<boolean>(resolve => {\n    resolveFunction = resolve;\n  });\n  \n  const alert = await this.alertController.create({\n    header: 'Confirm Navigation',\n    message: 'You are about to be navigated out of this application. Click OK to continue.',\n    buttons: [\n      {\n        text: 'OK',\n          handler: () => resolveFunction(true)\n      }\n    ]\n  });\n\n  await alert.present();\n  return promise;\n}\n\n  setPickupTime(pickupTime){\n    let date = new Date(pickupTime);  \n    this.pickupTime =  date.toString();\n  }\n\n}\n\n\n"]}