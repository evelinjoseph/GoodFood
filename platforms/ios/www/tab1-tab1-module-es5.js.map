{"version":3,"sources":["webpack:///src/app/tab1/tab1.page.html","webpack:///src/app/tab1/tab1-routing.module.ts","webpack:///src/app/tab1/tab1.module.ts","webpack:///src/app/tab1/tab1.page.scss","webpack:///src/app/tab1/tab1.page.ts"],"names":["routes","path","component","Tab1PageRoutingModule","imports","forChild","exports","Tab1PageModule","declarations","Tab1Page","listingService","afStorage","activatedRoute","nacCtrl","afAuth","firestore","changeDetection","loadingController","alertController","searchText","searchBy","isReady","presentLoading","initializeItems","listings","listing","retailers","getUsers","filter","currentListing","isRetailer","self","forEach","element","ind","array","ref","retailerUID","getDownloadURL","toPromise","then","url","retailerURL","error","storageRef","data","deleteDate","description","listingID","location","price","quantity","retailerType","listingsBackup","event","searchTerm","srcElement","value","detectChanges","matchingRetailers","retailer","name","toLowerCase","indexOf","length","i","presentAlertRadio","create","cssClass","header","inputs","type","label","checked","buttons","text","role","handler","alert","present","duration","translucent","backdropDismiss","loading","onDidDismiss","target","complete","uid","user","find","selector","template"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACIf,UAAMA,MAAM,GAAW,CACrB;AACEC,YAAI,EAAE,EADR;AAEEC,iBAAS,EAAE;AAFb,OADqB,CAAvB;;UAWaC,qBAAqB;AAAA;AAAA,O;;AAArBA,2BAAqB,6DAJjC,+DAAS;AACRC,eAAO,EAAE,CAAC,6DAAaC,QAAb,CAAsBL,MAAtB,CAAD,CADD;AAERM,eAAO,EAAE,CAAC,4DAAD;AAFD,OAAT,CAIiC,GAArBH,qBAAqB,CAArB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCEAI,cAAc;AAAA;AAAA,O;;AAAdA,oBAAc,6DAT1B,+DAAS;AACRH,eAAO,EAAE,CACP,0DADO,EAEP,4DAFO,EAGP,0DAHO,EAIP,0EAJO,CADD;AAORI,oBAAY,EAAE,CAAC,mDAAD;AAPN,OAAT,CAS0B,GAAdD,cAAc,CAAd;;;;;;;;;;;;;;;;ACjBb;AAAe;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UCaFE,QAAQ;AAenB,0BAAmBC,cAAnB,EAA4DC,SAA5D,EAAmGC,cAAnG,EAA2IC,OAA3I,EAA0KC,MAA1K,EAA2MC,SAA3M,EAAgPC,eAAhP,EAA2RC,iBAA3R,EAAwUC,eAAxU,EAA0W;AAAA;;AAAvV,eAAAR,cAAA,GAAAA,cAAA;AAAyC,eAAAC,SAAA,GAAAA,SAAA;AAAuC,eAAAC,cAAA,GAAAA,cAAA;AAAwC,eAAAC,OAAA,GAAAA,OAAA;AAA+B,eAAAC,MAAA,GAAAA,MAAA;AAAiC,eAAAC,SAAA,GAAAA,SAAA;AAAqC,eAAAC,eAAA,GAAAA,eAAA;AAA2C,eAAAC,iBAAA,GAAAA,iBAAA;AAA6C,eAAAC,eAAA,GAAAA,eAAA;AAVxU,eAAAC,UAAA,GAAa,oBAAb;AACA,eAAAC,QAAA,GAAW,UAAX;AAKA,eAAAC,OAAA,GAAmB,KAAnB;AAI4W;;AAfzV;AAAA;AAAA,qCAkBF;;;;;;AACf,2BAAKC,cAAL;;AACgB,6BAAM,KAAKC,eAAL,EAAN;;;AAAhB,2BAAKC,Q;;;;;;;;;AAEN;AAtBkB;AAAA;AAAA,4CAwBA;;;;;;;;AACE,6BAAM,KAAKd,cAAL,CAAoBa,eAApB,EAAN;;;AAAjBE,6B;AACJ,2BAAKC,SAAL,GAAiB,KAAKhB,cAAL,CAAoBiB,QAApB,GAA+BC,MAA/B,CAAsC,UAAAC,cAAc,EAAI;AACvE,4BAAIA,cAAc,CAACC,UAAnB,EAA+B;AAC7B,iCAAQD,cAAc,CAACC,UAAvB;AACD;AACF,uBAJgB,CAAjB;AAKIC,0B,GAAO,I;AACXN,6BAAO,CAACO,OAAR,CAAgB,UAAeC,OAAf,EAAwBC,GAAxB,EAA6BC,KAA7B,EAAoC;;;;;;;;AAEhC,yCAAMJ,IAAI,CAACpB,SAAL,CAAeyB,GAAf,kBAA6BH,OAAO,CAACI,WAArC,GAAoDC,cAApD,GAAqEC,SAArE,GAAiFC,IAAjF,CAAsF,UAASC,GAAT,EAAc;AAC1HC,+CAAW,GAAGD,GAAd;AACF,mCAFwB,WAEhB,UAASE,KAAT,EAAgB;AACvBD,+CAAW,GAAG,2BAAd;AACD,mCAJwB,CAAN;;;AAAdE,4C;AAKEC,sC,GAAO;AACXC,8CAAU,EAAEb,OAAO,CAACa,UADT;AAEXC,+CAAW,EAAEd,OAAO,CAACc,WAFV;AAGXC,6CAAS,EAAEf,OAAO,CAACe,SAHR;AAIXC,4CAAQ,EAAEhB,OAAO,CAACgB,QAJP;AAKXC,yCAAK,EAAEjB,OAAO,CAACiB,KALJ;AAMXC,4CAAQ,EAAElB,OAAO,CAACkB,QANP;AAOXC,gDAAY,EAAEnB,OAAO,CAACmB,YAPX;AAQXf,+CAAW,EAAEJ,OAAO,CAACI,WARV;AASXI,uCAAG,EAAEC;AATM,mC;AAWbP,uCAAK,CAACD,GAAD,CAAL,GAAaW,IAAb;;;;;;;;;AACD,uBAnBD;AAqBA,2BAAKQ,cAAL,GAAsB5B,OAAtB;wDACOA,O;;;;;;;;;AACR;AAvDoB;AAAA;AAAA,iCAyDZ6B,KAzDY,EAyDP;AACV,iBAAK9B,QAAL,GAAgB,KAAK6B,cAArB;AACA,gBAAME,UAAU,GAAGD,KAAK,CAACE,UAAN,CAAiBC,KAApC;;AAEA,gBAAG,CAACF,UAAJ,EAAe;AACb,mBAAKvC,eAAL,CAAqB0C,aAArB;AACA;AACD;;AAED,gBAAG,KAAKtC,QAAL,IAAiB,UAApB,EAA+B;AAC7B,kBAAIuC,iBAAiB,GAAG,EAAxB;AACAA,+BAAiB,GAAG,KAAKjC,SAAL,CAAeE,MAAf,CAAsB,UAAAgC,QAAQ,EAAI;AACpD,uBAAQA,QAAQ,CAACC,IAAT,CAAcC,WAAd,GAA4BC,OAA5B,CAAoCR,UAAU,CAACO,WAAX,EAApC,IAAgE,CAAC,CAAzE;AACD,eAFmB,CAApB;AAIE,mBAAKtC,QAAL,GAAgB,KAAKA,QAAL,CAAcI,MAAd,CAAqB,UAAAC,cAAc,EAAI;AACrD,oBAAG8B,iBAAiB,CAACK,MAAlB,GAAyB,CAAzB,IAA8BnC,cAAc,CAACQ,WAAhD,EAA4D;AAC1D,uBAAI,IAAI4B,CAAC,GAAG,CAAZ,EAAeA,CAAC,GAACN,iBAAiB,CAACK,MAAnC,EAA2CC,CAAC,EAA5C,EAA+C;AAC7C,wBAAGpC,cAAc,CAACQ,WAAf,CAA2ByB,WAA3B,GAAyCC,OAAzC,CAAiDJ,iBAAiB,CAACM,CAAD,CAAjB,CAAqB5B,WAArB,CAAiCyB,WAAjC,EAAjD,IAAkG,CAAC,CAAtG,EAAwG;AACtG,6BAAO,IAAP;AACD;AACF;AACF;AAEF,eATe,CAAhB;AAWH,aAjBD,MAmBK,IAAG,KAAK1C,QAAL,IAAiB,UAApB,EAA+B;AAClC,mBAAKI,QAAL,GAAgB,KAAKA,QAAL,CAAcI,MAAd,CAAqB,UAAAC,cAAc,EAAI;AACrD,oBAAIA,cAAc,CAACoB,QAAf,IAA2BM,UAA/B,EAA2C;AACzC,yBAAQ1B,cAAc,CAACoB,QAAf,CAAwBa,WAAxB,GAAsCC,OAAtC,CAA8CR,UAAU,CAACO,WAAX,EAA9C,IAA0E,CAAC,CAAnF;AACD;AACF,eAJe,CAAhB;AAKD,aANI,MAQA,IAAG,KAAK1C,QAAL,IAAiB,eAApB,EAAoC;AACvC,mBAAKI,QAAL,GAAgB,KAAKA,QAAL,CAAcI,MAAd,CAAqB,UAAAC,cAAc,EAAI;AACrD,oBAAIA,cAAc,CAACuB,YAAf,IAA+BG,UAAnC,EAA+C;AAC7C,yBAAQ1B,cAAc,CAACuB,YAAf,CAA4BU,WAA5B,GAA0CC,OAA1C,CAAkDR,UAAU,CAACO,WAAX,EAAlD,IAA8E,CAAC,CAAvF;AACD;AACF,eAJe,CAAhB;AAKD;;AACD,iBAAK9C,eAAL,CAAqB0C,aAArB;AACD;AArGkB;AAAA;AAAA,yCAuGP;AACV,iBAAKQ,iBAAL;AACA,iBAAKlD,eAAL,CAAqB0C,aAArB;AACD;AA1GkB;AAAA;AAAA,8CA4GO;;;;;;;;;;AACV,6BAAM,KAAKxC,eAAL,CAAqBiD,MAArB,CAA4B;AAC9CC,gCAAQ,EAAE,iBADoC;AAE9CC,8BAAM,EAAE,YAFsC;AAG9CC,8BAAM,EAAE,CACN;AACET,8BAAI,EAAE,QADR;AAEEU,8BAAI,EAAE,OAFR;AAGEC,+BAAK,EAAE,UAHT;AAIEf,+BAAK,EAAE,UAJT;AAKEgB,iCAAO,EAAE;AALX,yBADM,EAQN;AACEZ,8BAAI,EAAE,QADR;AAEEU,8BAAI,EAAE,OAFR;AAGEC,+BAAK,EAAE,eAHT;AAIEf,+BAAK,EAAE;AAJT,yBARM,EAcN;AACEI,8BAAI,EAAE,QADR;AAEEU,8BAAI,EAAE,OAFR;AAGEC,+BAAK,EAAE,UAHT;AAIEf,+BAAK,EAAE;AAJT,yBAdM,CAHsC;AAwB9CiB,+BAAO,EAAE,CACP;AACEC,8BAAI,EAAE,QADR;AAEEC,8BAAI,EAAE,QAFR;AAGER,kCAAQ,EAAE,WAHZ;AAIES,iCAAO,EAAE,mBAAM,CACd;AALH,yBADO,EAOJ;AACDF,8BAAI,EAAE,IADL;AAEDE,iCAAO,EAAE,iBAAChC,IAAD,EAAiB;AACxB,iCAAI,CAAC1B,UAAL,GAAkB,eAAe0B,IAAjC;AACA,iCAAI,CAACzB,QAAL,GAAgByB,IAAhB;AAED;AANA,yBAPI;AAxBqC,uBAA5B,CAAN;;;AAARiC,2B;;AA0CN,6BAAMA,KAAK,CAACC,OAAN,EAAN;;;;;;;;;AACD;AAxJkB;AAAA;AAAA,2CA0JI;;;;;;;;;AACL,6BAAM,KAAK9D,iBAAL,CAAuBkD,MAAvB,CAA8B;AAClDa,gCAAQ,EAAE,GADwC;AAElDC,mCAAW,EAAE,IAFqC;AAGlDb,gCAAQ,EAAE,aAHwC;AAIlDc,uCAAe,EAAE;AAJiC,uBAA9B,CAAN;;;AAAVC,6B;;AAMN,6BAAMA,OAAO,CAACJ,OAAR,EAAN;;;;AAEuB,6BAAMI,OAAO,CAACC,YAAR,EAAN;;;;AAAfR,0B,yBAAAA,I;AAAM/B,0B,yBAAAA,I;AACd,2BAAKxB,OAAL,GAAe,IAAf;AACA,2BAAKL,eAAL,CAAqB0C,aAArB;;;;;;;;;AACD;AAtKkB;AAAA;AAAA,oCAwKHJ,KAxKG,EAwKI;;;;;;;AAGL,6BAAM,KAAK/B,eAAL,EAAN;;;AAAhB,2BAAKC,Q;AACL8B,2BAAK,CAAC+B,MAAN,CAAaC,QAAb;;;;;;;;;AACD;AA7KkB;AAAA;AAAA,sCAgLLC,GAhLK,EAgLA;AACf,gBAAG,KAAK7D,SAAR,EAAkB;AACjB,kBAAM8D,IAAI,GAAG,KAAK9D,SAAL,CAAe+D,IAAf,CAAoB,UAAAxD,OAAO;AAAA,uBAAIA,OAAO,CAACI,WAAR,IAAuBkD,GAA3B;AAAA,eAA3B,CAAb;AACA,qBAAOC,IAAI,CAAC3B,IAAZ;AAEA;AACF;AAtLgB;;AAAA;AAAA,S;;;;gBAPZ;;gBAFA;;gBACA;;gBAHoC;;gBADpC;;gBAEA;;gBAHmB;;gBAEnB;;gBAAmB;;;;AAWfpD,cAAQ,6DALpB,gEAAU;AACTiF,gBAAQ,EAAE,UADD;AAETC,gBAAQ,EAAR;AAAA;AAAA,0FAFS;;;;AAAA,OAAV,CAKoB,GAARlF,QAAQ,CAAR","file":"tab1-tab1-module-es5.js","sourcesContent":["export default \"<ion-header>\\n  <ion-toolbar mode=\\\"ios\\\" color=\\\"primary\\\">\\n    <ion-title>Good Food</ion-title>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-menu-button autoHide=\\\"false\\\"></ion-menu-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content fullscreen [hidden]=\\\"!isReady\\\"> \\n\\n  <ion-refresher slot=\\\"fixed\\\" (ionRefresh)=\\\"doRefresh($event)\\\">\\n    <ion-refresher-content></ion-refresher-content>\\n  </ion-refresher>\\n  \\n  <br>\\n  <ion-toolbar> \\n    <ion-row>\\n      <ion-col size=\\\"10\\\">\\n      <ion-searchbar mode=\\\"ios\\\" (ionInput)=\\\"search($event)\\\" placeholder = {{searchText}}></ion-searchbar>\\n    </ion-col>\\n      <ion-col size=\\\"1\\\">\\n      <ion-icon size=\\\"4\\\" name=\\\"options\\\" (click)=\\\"filterSearch()\\\"></ion-icon>\\n    </ion-col>\\n  </ion-row> \\n    </ion-toolbar> \\n    \\n  <div *ngFor=\\\"let item of listings\\\">   \\n    <ion-card [routerLink]=\\\"['/user-listing']\\\" [queryParams]=\\\"{ id: item.listingID }\\\" routerDirection=\\\"forward\\\">\\n             \\n        <img src={{item.url}} style=\\\"width:100%;\\\"> \\n        <ion-card-header> \\n          <ion-card-title class=\\\"ion-text-wrap\\\">{{getRetailer(item.retailerUID)}}</ion-card-title> \\n        </ion-card-header>\\n   \\n     <ion-card-content> \\n      <p style=\\\"font-weight: bold; color:black\\\"> {{item.quantity}} meals left</p>\\n       <p> Price: ${{item.price | number:'1.2-2'}}</p>\\n       <p> Location: {{item.location}}</p>\\n       <p> Retailer Type: {{item.retailerType}}</p>\\n     </ion-card-content>\\n   </ion-card>\\n  </div>\\n</ion-content>\";","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { Tab1Page } from './tab1.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: Tab1Page,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class Tab1PageRoutingModule {}\n","import { IonicModule } from '@ionic/angular';\nimport { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Tab1Page } from './tab1.page';\n\nimport { Tab1PageRoutingModule } from './tab1-routing.module';\n\n@NgModule({\n  imports: [\n    IonicModule,\n    CommonModule,\n    FormsModule,\n    Tab1PageRoutingModule\n  ],\n  declarations: [Tab1Page]\n})\nexport class Tab1PageModule {}\n","export default \"ion-icon {\\n  font-size: 35px;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdGFiMS90YWIxLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGVBQUE7QUFDSiIsImZpbGUiOiJzcmMvYXBwL3RhYjEvdGFiMS5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyJpb24taWNvbiB7XG4gICAgZm9udC1zaXplOiAzNXB4O1xufSJdfQ== */\";","import { Component, OnInit, ChangeDetectorRef } from '@angular/core';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { LoadingController, AlertController, NavController } from '@ionic/angular';\nimport { AngularFirestore } from '@angular/fire/firestore';\nimport { AngularFireStorage } from '@angular/fire/storage';\nimport { ActivatedRoute } from '@angular/router';\nimport { ListingsService} from '../listings.service';\n\n@Component({\n  selector: 'app-tab1',\n  templateUrl: 'tab1.page.html',\n  styleUrls: ['tab1.page.scss']\n})\nexport class Tab1Page implements OnInit{\n\n  public listings: any[];\n  public listingsBackup: any[];\n  deleteListings: any[];\n  searchText = \"Search By Retailer\";\n  searchBy = \"Retailer\";\n  dateNow;\n  url; \n  retailerUID;\n  ID;\n  isReady: Boolean = false;\n  retailers: any[];\n\n\n  constructor(public listingService: ListingsService, private afStorage: AngularFireStorage, private activatedRoute: ActivatedRoute, private nacCtrl: NavController, public afAuth: AngularFireAuth, private firestore: AngularFirestore, private changeDetection: ChangeDetectorRef, public loadingController: LoadingController, public alertController: AlertController) {}\n\n\n  async ngOnInit() {\n    this.presentLoading(); \n    this.listings = await this.initializeItems();\n    \n  }\n\nasync initializeItems(): Promise<any> {\n  let listing: any[] = await this.listingService.initializeItems();  \n  this.retailers = this.listingService.getUsers().filter(currentListing => {\n    if (currentListing.isRetailer) {\n      return (currentListing.isRetailer);\n    }\n  });  \n  var self = this;\n  listing.forEach(async function(element, ind, array) { \n  var retailerURL;\n    var storageRef =  await self.afStorage.ref(`images/${element.retailerUID}`).getDownloadURL().toPromise().then(function(url) {\n      retailerURL = url;\n   }).catch(function(error) {\n     retailerURL = 'assets/images/default.png';\n   });\n    const data = {\n      deleteDate: element.deleteDate,\n      description: element.description,\n      listingID: element.listingID,\n      location: element.location,\n      price: element.price,\n      quantity: element.quantity,\n      retailerType: element.retailerType,     \n      retailerUID: element.retailerUID,\n      url: retailerURL      \n    }   \n    array[ind] = data \n  });\n\n  this.listingsBackup = listing;  \n  return listing;\n}\n\n  search(event){\n    this.listings = this.listingsBackup;\n    const searchTerm = event.srcElement.value;\n\n    if(!searchTerm){\n      this.changeDetection.detectChanges(); \n      return;\n    }\n\n    if(this.searchBy == \"Retailer\"){\n      let matchingRetailers = [];\n      matchingRetailers = this.retailers.filter(retailer => {\n        return (retailer.name.toLowerCase().indexOf(searchTerm.toLowerCase()) > -1);\n      });     \n      \n        this.listings = this.listings.filter(currentListing => {\n          if(matchingRetailers.length>0 && currentListing.retailerUID){\n            for(var i = 0; i<matchingRetailers.length; i++){\n              if(currentListing.retailerUID.toLowerCase().indexOf(matchingRetailers[i].retailerUID.toLowerCase())> -1){\n                return true;\n              }\n            } \n          }                         \n          \n        });\n      \n    }\n\n    else if(this.searchBy == \"Location\"){\n      this.listings = this.listings.filter(currentListing => {\n        if (currentListing.location && searchTerm) {\n          return (currentListing.location.toLowerCase().indexOf(searchTerm.toLowerCase()) > -1);\n        }\n      });\n    }\n\n    else if(this.searchBy == \"Retailer Type\"){\n      this.listings = this.listings.filter(currentListing => {\n        if (currentListing.retailerType && searchTerm) {\n          return (currentListing.retailerType.toLowerCase().indexOf(searchTerm.toLowerCase()) > -1);\n        }\n      });\n    }     \n    this.changeDetection.detectChanges(); \n  }\n\n  filterSearch(){\n    this.presentAlertRadio();\n    this.changeDetection.detectChanges(); \n  }\n\n  async presentAlertRadio() {\n    const alert = await this.alertController.create({\n      cssClass: 'my-custom-class',\n      header: 'Search By:',\n      inputs: [\n        {\n          name: 'radio1',\n          type: 'radio',\n          label: 'Retailer',\n          value: 'Retailer',\n          checked: true \n        },\n        {\n          name: 'radio2',\n          type: 'radio',\n          label: 'Retailer Type',\n          value: 'Retailer Type'\n        },\n        {\n          name: 'radio3',\n          type: 'radio',\n          label: 'Location',\n          value: 'Location'\n        }\n      ],\n      buttons: [\n        {\n          text: 'Cancel',\n          role: 'cancel',\n          cssClass: 'secondary',\n          handler: () => {\n          }\n        }, {\n          text: 'OK',\n          handler: (data:string) => {\n            this.searchText = \"Search By \" + data;\n            this.searchBy = data;\n            \n          }\n        }\n      ]\n    });\n\n    await alert.present();\n  }\n\n  async presentLoading() {\n    const loading = await this.loadingController.create({\n      duration: 700,\n      translucent: true,\n      cssClass: 'transparent',\n      backdropDismiss: false\n    });\n    await loading.present();\n\n    const { role, data } = await loading.onDidDismiss();\n    this.isReady = true; \n    this.changeDetection.detectChanges(); \n  }\n\n  async doRefresh(event) {\n    // this.isReady = false;\n    // this.presentLoading();\n    this.listings = await this.initializeItems();    \n    event.target.complete();\n  }\n\n  \n    getRetailer(uid) : String{  \n      if(this.retailers){\n       const user = this.retailers.find(element => element.retailerUID == uid);    \n       return user.name;\n \n      }\n    }\n\n  \n\n}"]}