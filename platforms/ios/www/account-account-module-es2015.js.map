{"version":3,"sources":["./src/app/account/account.page.html","./src/app/account/account-routing.module.ts","./src/app/account/account.module.ts","./src/app/account/account.page.scss","./src/app/account/account.page.ts"],"names":[],"mappings":"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","file":"account-account-module-es2015.js","sourcesContent":["export default \"<ion-header style=\\\"text-align: center\\\">\\n  <ion-toolbar color=\\\"primary\\\" mode=\\\"ios\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button [text]=\\\"Back\\\" defaultHref=\\\"/tabs/tabs/tab1\\\"></ion-back-button>\\n    </ion-buttons>\\n    <ion-title>\\n      Good Food\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n\\n  <h1 style=\\\"text-align: center;\\\"> {{firstName}} {{lastName}} </h1>\\n \\n  <ion-item >    \\n    <ion-label>\\n      First Name:\\n    </ion-label>\\n    <ion-textarea placeholder=\\\"{{ firstName }}\\\" [readonly]=\\\"isRead\\\" [(ngModel)]=\\\"firstName\\\" ></ion-textarea>\\n  </ion-item>\\n\\n  <ion-item >    \\n    <ion-label>\\n      Last Name:\\n    </ion-label>\\n    <ion-textarea placeholder=\\\"{{ lastName }}\\\" [readonly]=\\\"isRead\\\" [(ngModel)]=\\\"lastName\\\" ></ion-textarea>\\n  </ion-item>\\n\\n   <ion-item >    \\n        <ion-label>\\n          User UID:\\n        </ion-label>\\n        <ion-textarea placeholder=\\\"{{ userUID }}\\\" [readonly]=true  ></ion-textarea>\\n    </ion-item>\\n\\n     <ion-item >    \\n        <ion-label>\\n          Email Address:\\n        </ion-label>\\n        <ion-textarea placeholder=\\\"{{ email }}\\\" [readonly]=true  ></ion-textarea>\\n    </ion-item>\\n \\n    \\n    <div style=\\\"text-align: center\\\"> \\n      \\n      <section >\\n        <br>\\n        <ion-button expand=\\\"block\\\" (click)=\\\"edit()\\\">{{buttonText}}</ion-button>\\n      </section>\\n\\n      <section>\\n        <ion-button expand=\\\"block\\\" (click)=\\\"updatePassword()\\\">Update Password</ion-button>\\n      </section>\\n\\n      <section >\\n        <br>\\n        <ion-text color=\\\"danger\\\"  (click)=\\\"deleteAccount()\\\">\\n          <u>Delete Account?</u>\\n        </ion-text>\\n      </section>\\n    </div>\\n\\n</ion-content>\\n\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { AccountPage } from './account.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: AccountPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class AccountPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { AccountPageRoutingModule } from './account-routing.module';\n\nimport { AccountPage } from './account.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    AccountPageRoutingModule\n  ],\n  declarations: [AccountPage]\n})\nexport class AccountPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2FjY291bnQvYWNjb3VudC5wYWdlLnNjc3MifQ== */\";","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { AngularFireAuth } from '@angular/fire/auth';\nimport { AngularFirestore } from '@angular/fire/firestore';\nimport { ActivatedRoute } from '@angular/router';\nimport * as firebase from 'firebase/app';\nimport { AlertController } from '@ionic/angular';\nimport { NavController } from '@ionic/angular';\n\n@Component({\n  selector: 'app-account',\n  templateUrl: './account.page.html',\n  styleUrls: ['./account.page.scss'],\n})\nexport class AccountPage implements OnInit {\n\n  userUID;\n  firstName;\n  lastName;\n  email;\n  buttonText: string = \"Edit\";\n  isRead: boolean = true;\n\n  constructor(public nacCtrl: NavController, private activatedRoute: ActivatedRoute, private firestore: AngularFirestore, private changeDetection: ChangeDetectorRef, public afAuth: AngularFireAuth, public alertController: AlertController) { }\n\n  async ngOnInit() {\n    try{\n    var self = this;\n    await (this.afAuth.onAuthStateChanged(async function(user) {             \n      if (user) {        \n        self.userUID = user.uid\n          var userRef = (await self.firestore.collection(\"users\").doc(self.userUID).get().toPromise()).data()          \n              self.firstName = userRef.firstname;\n              self.lastName = userRef.lastname; \n              self.email = userRef.email; \n              self.changeDetection.detectChanges();                 \n      }\n      else{\n        console.log('no user signed in');\n      }\n    }));    \n      \n  }\n  catch(error){\n    console.log(error.message)\n  }\n  this.changeDetection.detectChanges();\n}\n\nedit()\n  {\n    if(this.buttonText == \"Edit\"){\n      this.isRead = false;\n      this.buttonText = \"Save\";\n     }\n    else{  \n      \n      const { firstName, lastName } = this\n      if(firstName.trim().length != 0 && lastName.trim().length != 0){\n        try{\n          this.firestore.doc(`users/${this.userUID}`).update({          \n            firstname: this.firstName,\n            lastname: this.lastName              \n          })\n          this.isRead = true;\n          this.buttonText = \"Edit\";\n        }catch(error){  \n          console.log(error.message)\n        }   \n      }else {\n       this.presentAlert(\"Please enter a value for name\");   \n           \n      }  \n      \n    }   \n  }\n  \n  public async presentAlert(errorMessage) : Promise<boolean> {\n    let resolveFunction: (confirm: boolean) => void;\n    const promise = new Promise<boolean>(resolve => {\n      resolveFunction = resolve;\n    });\n    \n    const alert = await this.alertController.create({\n      header: 'Error',\n      message: errorMessage,\n      buttons: [\n        {\n          text: 'OK',\n            handler: () => resolveFunction(true)\n        }\n      ]\n    });\n    \n  await alert.present();\n  return promise;\n}\n\n  updatePassword(){        \n    this.nacCtrl.navigateRoot(['./update-password'])\n  }\n\n  async deleteAccount(){\n    //let self = this;\n    const confirm = await this.presentAlertDelete();\n    var userRef = (await this.firestore.collection(\"users\").doc(this.userUID).get().toPromise()).data() \n    if (confirm) {  \n     try{\n\n      (await this.afAuth.currentUser).delete();\n\n      this.firestore.collection('archive').doc(this.userUID).set({\n            deleteTime: new Date(),\n            email: userRef.email,\n            firstname: userRef.firstname,\n            lastname: userRef.lastname,\n            isRetailer: userRef.isRetailer,\n            orders: userRef.orders,\n            type: \"User Account\"\n       });\n\n       this.firestore.doc(`users/${this.userUID}`).delete();\n       this.nacCtrl.navigateRoot(['./login']);\n       console.log(\"user deleted\");\n     }\n     catch(error){\n       console.log(error)\n     }\n\n      // firebase.auth().currentUser.delete().then(function() {\n      //   // User deleted.       \n      //   console.log(\"entered then\")  \n      //   console.log(self.userUID);\n      //   console.log(userRef);\n      //   self.firestore.collection('archive').doc(self.userUID).set({\n      //     email: userRef.email,\n      //     firstname: userRef.firstname,\n      //     lastname: userRef.lastname,\n      //     isRetailer: userRef.isRetailer,\n      //     orders: userRef.orders,\n      //     type: \"User Account\"\n      //   })\n      //   .then(function() {\n      //       console.log(\"Document successfully written to Archive!\");\n      //   })\n      //   .catch(function(error) {\n      //       console.error(\"Error writing document: \", error);\n      //   });        \n      //   self.firestore.doc(`users/${self.userUID}`).delete();\n      //   self.nacCtrl.navigateRoot(['./login'])\n      //   console.log(\"user deleted\")\n      // }).catch(function(error) {\n      //   console.log(error)\n      //   console.log(\"Error deleting user\")\n      // });\n    }\n  }\n\n  async presentAlertDelete() : Promise<boolean> {\n    let resolveFunction: (confirm: boolean) => void;\n    const promise = new Promise<boolean>(resolve => {\n      resolveFunction = resolve;\n    });\n    const alert = await this.alertController.create({\n      header: 'Confirm Delete',\n      message: 'Are you sure you want to delete this account? This is a permanent deletion and cannot be undone. Please enter your password to continue',\n      inputs: [        \n        {\n          name: 'password',\n          placeholder: 'Password',\n          type: 'password'\n        }\n      ],\n      buttons: [\n        {\n          text: 'Cancel',\n          handler: () => resolveFunction(false)\n        },\n        {\n          text: 'Yes',\n          handler: data => {\n            this.afAuth.signInWithEmailAndPassword(firebase.auth().currentUser.email, data.password).then(function(){\n              console.log(\"signed in\")\n              resolveFunction(true)\n            }).catch(function(error){\n              console.log(error.message)\n            })           \n                      \n          }\n        }\n      ]\n    });\n\n    await alert.present();\n    return promise;\n  }\n}\n"],"sourceRoot":"webpack:///"}