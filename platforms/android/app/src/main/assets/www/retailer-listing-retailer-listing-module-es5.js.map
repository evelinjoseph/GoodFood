{"version":3,"sources":["webpack:///src/app/retailer-listing/retailer-listing.page.html","webpack:///src/app/retailer-listing/retailer-listing-routing.module.ts","webpack:///src/app/retailer-listing/retailer-listing.module.ts","webpack:///src/app/retailer-listing/retailer-listing.page.scss","webpack:///src/app/retailer-listing/retailer-listing.page.ts"],"names":["routes","path","component","RetailerListingPageRoutingModule","imports","forChild","exports","RetailerListingPageModule","declarations","RetailerListingPage","listingService","nacCtrl","activatedRoute","afAuth","afstore","afStorage","changeDetection","loadingController","alertController","isReady","buttonText","isRead","presentLoading","listingID","snapshot","queryParamMap","get","self","onAuthStateChanged","user","retailerUID","uid","collection","doc","toPromise","userRef","data","retailer","name","location","retailerType","listing","listings","pickupTime","toDate","toLocaleString","filter","currentListing","toLowerCase","indexOf","isListed","listingRef","deleteDate","storageRef","ref","getDownloadURL","then","url","error","detectChanges","console","log","create","duration","translucent","cssClass","backdropDismiss","loading","present","onDidDismiss","role","date","Date","pickupDate","description","price","quantity","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","set","update","FieldValue","arrayUnion","arrayRemove","presentAlert","navigateRoot","promise","Promise","resolve","resolveFunction","header","buttons","text","handler","alert","presentAlertUnpublish","confirm","deleteListing","message","time","toString","pDate","toDateString","newDate","selector","template"],"mappings":"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","file":"retailer-listing-retailer-listing-module-es5.js","sourcesContent":["export default \"<ion-header style=\\\"text-align: center\\\">\\r\\n  <ion-toolbar color=\\\"primary\\\" mode=\\\"ios\\\">\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-back-button [text]=\\\"Back\\\" defaultHref=\\\"/retailertabs/retailertabs/retailertab2\\\"></ion-back-button>\\r\\n    </ion-buttons>\\r\\n    <ion-title>\\r\\n      Good Food\\r\\n    </ion-title>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content [hidden]=\\\"!isReady\\\" fullscreen >\\r\\n  <div *ngFor=\\\"let item of listing\\\"> \\r\\n  <img [src]=\\\"url\\\" style=\\\"width:100%;\\\"> \\r\\n\\r\\n  <h1 style=\\\"text-align: center; font-weight: bold\\\"> {{ retailer }}</h1>\\r\\n  <hr>\\r\\n  <ion-text color=\\\"primary\\\">\\r\\n  <h3 style=\\\"text-align: center; font-weight: bold;\\\" > ${{ item.price | number:'1.2-2' }}</h3>\\r\\n  </ion-text> \\r\\n\\r\\n  <div style=\\\"text-align: center; font-size: large;\\\">\\r\\n    <ion-icon name=\\\"location-outline\\\"></ion-icon> \\r\\n    {{ location }}\\r\\n  </div>\\r\\n\\r\\n  <p style=\\\"text-align: center\\\"> {{ item.quantity }} meals left</p>  \\r\\n  <hr>\\r\\n  <div style=\\\"text-align: center\\\" *ngIf=\\\"!item.isListed\\\">\\r\\n  <ion-icon name=\\\"time-outline\\\"></ion-icon>\\r\\n  Pickup Time: {{pickupTime | date:'h:mm a'}}\\r\\n  </div>\\r\\n\\r\\n  <div style=\\\"text-align: center\\\" *ngIf=\\\"item.isListed\\\">\\r\\n    <ion-icon name=\\\"time-outline\\\"></ion-icon>\\r\\n    Listing Delete Date: {{pickupTime}}\\r\\n    </div>\\r\\n  <hr>\\r\\n  <!-- after publish and clicking on edit -->\\r\\n  <ion-item [hidden]=\\\"isRead\\\">\\r\\n    <ion-label>Delete Date</ion-label>\\r\\n    <ion-datetime value={{pickupTime}} [(ngModel)]=\\\"pDate\\\" (ionChange)=\\\"setPickupDate(this.pDate)\\\"></ion-datetime>\\r\\n  </ion-item>\\r\\n  <ion-item [hidden]=\\\"isRead\\\">\\r\\n    <ion-label>Delete/Pick Up Time</ion-label>\\r\\n    <ion-datetime value={{pickupTime}} display-format=\\\"h:mm A\\\" picker-format=\\\"h:mm A\\\" [(ngModel)]=\\\"time\\\" (ionChange)=\\\"setPickupTime(this.time)\\\"></ion-datetime>\\r\\n  </ion-item> \\r\\n  <p style=\\\"text-align: center; font-size: large;\\\"> {{ item.description }} </p>\\r\\n</div>\\r\\n</ion-content>\\r\\n\\r\\n<ion-toolbar [hidden]=\\\"!isReady\\\" position=\\\"bottom\\\" style=\\\"text-align: center;\\\" color=\\\"translucent\\\" *ngFor=\\\"let item of listing\\\"> \\r\\n  <ion-button *ngIf=\\\"!item.isListed\\\" size =\\\"large\\\" (click)=\\\"publish(item)\\\">Publish</ion-button>\\r\\n  <ion-button *ngIf=\\\"item.isListed\\\" size =\\\"large\\\" (click)=\\\"edit(item)\\\">{{buttonText}}</ion-button>\\r\\n  <ion-button *ngIf=\\\"item.isListed\\\" size =\\\"large\\\" (click)=\\\"unpublish(item)\\\">Unpublish</ion-button>\\r\\n</ion-toolbar>\\r\\n\\r\\n\";","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { RetailerListingPage } from './retailer-listing.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: RetailerListingPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class RetailerListingPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { RetailerListingPageRoutingModule } from './retailer-listing-routing.module';\r\n\r\nimport { RetailerListingPage } from './retailer-listing.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    RetailerListingPageRoutingModule\r\n  ],\r\n  declarations: [RetailerListingPage]\r\n})\r\nexport class RetailerListingPageModule {}\r\n","export default \"hr {\\n  color: black;\\n  border-style: solid;\\n  background-color: black;\\n}\\n\\n.ion-text {\\n  display: flex;\\n  justify-content: center;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvcmV0YWlsZXItbGlzdGluZy9yZXRhaWxlci1saXN0aW5nLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLFlBQUE7RUFDQSxtQkFBQTtFQUNBLHVCQUFBO0FBQ0o7O0FBQ0E7RUFDSSxhQUFBO0VBQ0EsdUJBQUE7QUFFSiIsImZpbGUiOiJzcmMvYXBwL3JldGFpbGVyLWxpc3RpbmcvcmV0YWlsZXItbGlzdGluZy5wYWdlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyJociB7XHJcbiAgICBjb2xvcjogYmxhY2s7XHJcbiAgICBib3JkZXItc3R5bGU6IHNvbGlkO1xyXG4gICAgYmFja2dyb3VuZC1jb2xvcjogYmxhY2s7XHJcbiAgfVxyXG4uaW9uLXRleHR7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XHJcbn0iXX0= */\";","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { AngularFireAuth } from '@angular/fire/auth';\r\nimport { AngularFirestore } from '@angular/fire/firestore';\r\nimport { AngularFireStorage } from '@angular/fire/storage';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { AlertController, LoadingController, NavController } from '@ionic/angular';\r\nimport * as firebase from 'firebase/app';\r\nimport { ListingsService } from '../listings.service';\r\n\r\n@Component({\r\n  selector: 'app-retailer-listing',\r\n  templateUrl: './retailer-listing.page.html',\r\n  styleUrls: ['./retailer-listing.page.scss'],\r\n})\r\nexport class RetailerListingPage implements OnInit {\r\n\r\n  listingID;\r\n  listing: any[];  \r\n  location;\r\n  retailerUID;\r\n  retailer;\r\n  retailerType;\r\n  url;\r\n  isReady: Boolean = false;\r\n  pickupTime;\r\n  date;\r\n  pickupDate: Date;\r\n  time;\r\n  pDate;\r\n  buttonText: string = \"Edit\";\r\n  isRead: boolean = true;  \r\n\r\n  constructor(public listingService: ListingsService,private nacCtrl: NavController, private activatedRoute: ActivatedRoute, public afAuth: AngularFireAuth, private afstore: AngularFirestore, private afStorage: AngularFireStorage, private changeDetection: ChangeDetectorRef,public loadingController: LoadingController, public alertController: AlertController) { }\r\n\r\n  ngOnInit() {\r\n    this.presentLoading();\r\n    this.listingID = this.activatedRoute.snapshot.queryParamMap.get('id'); \r\n    var self = this\r\n    this.afAuth.onAuthStateChanged(async function(user) {        \r\n      if (user) {        \r\n        self.retailerUID = user.uid\r\n        var userRef = (await self.afstore.collection(\"users\").doc(self.retailerUID).get().toPromise()).data()\r\n        self.retailer = userRef.name;\r\n        self.location = userRef.location;\r\n        self.retailerType = userRef.retailerType;        \r\n        self.listing = userRef.listings; \r\n        self.pickupTime = userRef.pickupTime.toDate().toLocaleString();\r\n\r\n        self.listing = self.listing.filter(currentListing => {\r\n          if (currentListing.listingID && self.listingID) {\r\n            return (currentListing.listingID.toLowerCase().indexOf(self.listingID.toLowerCase()) > -1);\r\n          }\r\n        });\r\n\r\n        if(self.listing[0].isListed){\r\n          var listingRef = (await self.afstore.collection(\"listings\").doc(self.listingID).get().toPromise()).data()\r\n          self.pickupTime = listingRef.deleteDate.toDate().toLocaleString();\r\n        }\r\n        \r\n        \r\n        var storageRef =  self.afStorage.ref(`images/${self.retailerUID}`).getDownloadURL().toPromise().then(function(url) {        \r\n          self.url = url;\r\n       }).catch(function(error) {\r\n         self.url = 'assets/images/default.png';\r\n       });\r\n\r\n       self.changeDetection.detectChanges(); \r\n      }\r\n      else{\r\n        console.log('no user signed in');\r\n      }\r\n    });    \r\n  }\r\n\r\n  async presentLoading() {\r\n    const loading = await this.loadingController.create({\r\n      duration: 900,\r\n      translucent: true,\r\n      cssClass: 'transparent',\r\n      backdropDismiss: false\r\n    });\r\n    await loading.present();\r\n\r\n    const { role, data } = await loading.onDidDismiss();\r\n    this.isReady = true;\r\n    this.changeDetection.detectChanges(); \r\n  }\r\n\r\n  publish(listing) {\r\n    \r\n    this.date = new Date();\r\n    this.pickupDate = new Date(this.pickupTime);\r\n\r\n    const data = {\r\n      description: listing.description,\r\n      listingID: listing.listingID,\r\n      price: listing.price,\r\n      quantity: listing.quantity,\r\n      retailerType: this.retailerType,\r\n      location: this.location,\r\n      retailerUID: this.retailerUID,\r\n      deleteDate: new Date(this.date.getFullYear(), this.date.getMonth(), this.date.getDate(), this.pickupDate.getHours(), this.pickupDate.getMinutes(), this.pickupDate.getSeconds(), this.pickupDate.getMilliseconds())\r\n    }\r\n\r\n    this.afstore.collection(\"listings\").doc(this.listingID).set(data);\r\n    \r\n\r\n    this.afstore.doc(`users/${this.retailerUID}`).update({\r\n      listings: firebase.firestore.FieldValue.arrayUnion({\r\n        quantity: listing.quantity,\r\n        price: listing.price,\r\n        description: listing.description,\r\n        listingID: listing.listingID,\r\n        isListed: true      \r\n      })\r\n    })\r\n\r\n    this.afstore.doc(`users/${this.retailerUID}`).update({\r\n      listings: firebase.firestore.FieldValue.arrayRemove({\r\n        quantity: listing.quantity,\r\n        price: listing.price,\r\n        description: listing.description,\r\n        listingID: listing.listingID,\r\n        isListed: false      \r\n      })\r\n    })\r\n    this.changeDetection.detectChanges(); \r\n    this.presentAlert();\r\n    this.nacCtrl.navigateRoot([\"./retailertabs/retailertabs/retailertab2\"]);\r\n    this.changeDetection.detectChanges(); \r\n  }\r\n\r\n  public async presentAlert() : Promise<boolean> {\r\n    let resolveFunction: (confirm: boolean) => void;\r\n    const promise = new Promise<boolean>(resolve => {\r\n      resolveFunction = resolve;\r\n    });\r\n    \r\n    const alert = await this.alertController.create({\r\n      header: 'Listing Successfully Published!',\r\n      buttons: [\r\n        {\r\n          text: 'OK',\r\n            handler: () => resolveFunction(true)\r\n        }\r\n      ]\r\n    });\r\n\r\n    await alert.present();\r\n    return promise;\r\n  }\r\n\r\n  \r\n  async unpublish(listing){\r\n\r\n    const confirm = await this.presentAlertUnpublish();\r\n    if (confirm) {\r\n\r\n      this.afstore.doc(`users/${this.retailerUID}`).update({\r\n        listings: firebase.firestore.FieldValue.arrayUnion({\r\n          \r\n          description: listing.description,\r\n          listingID: listing.listingID,\r\n          price: listing.price,\r\n          quantity:listing.quantity,\r\n          isListed: false\r\n        })\r\n      })\r\n\r\n    this.afstore.doc(`users/${this.retailerUID}`).update({\r\n      listings: firebase.firestore.FieldValue.arrayRemove({\r\n        \r\n        description: listing.description,\r\n        listingID: listing.listingID,\r\n        price: listing.price,\r\n        quantity:listing.quantity,\r\n        isListed: listing.isListed\r\n      })\r\n    })\r\n\r\n    await this.listingService.deleteListing(listing)\r\n    this.afstore.collection('listings').doc(listing.listingID).delete();\r\n    this.nacCtrl.navigateRoot([\"./retailertabs/retailertabs/retailertab2\"]);\r\n    this.changeDetection.detectChanges(); \r\n   \r\n    \r\n    \r\n  }\r\n  }\r\n\r\n  async presentAlertUnpublish() : Promise<boolean> {\r\n    let resolveFunction: (confirm: boolean) => void;\r\n    const promise = new Promise<boolean>(resolve => {\r\n      resolveFunction = resolve;\r\n    });\r\n    const alert = await this.alertController.create({\r\n      header: 'Confirm Unpublish',\r\n      message: 'Are you sure you want to unpublish this listing?',\r\n      buttons: [\r\n        {\r\n          text: 'Yes',\r\n            handler: () => resolveFunction(true)\r\n        }, {\r\n          text: 'No',\r\n          handler: () => resolveFunction(false)\r\n        }\r\n      ]\r\n    });\r\n\r\n    await alert.present();\r\n    return promise;\r\n  }\r\n\r\n  setPickupTime(pickupTime){  \r\n\r\n    let date = new Date(pickupTime);  \r\n    this.time =  date.toString();\r\n    console.log(this.time)\r\n  }\r\n\r\n  setPickupDate(pickupDate){\r\n    console.log(pickupDate)\r\n    this.pDate = (new Date(pickupDate)).toDateString();  \r\n    console.log(this.pDate)\r\n  }\r\n\r\n  edit(listing)\r\n  {\r\n    if(this.buttonText == \"Edit\"){\r\n      this.isRead = false;\r\n      this.buttonText = \"Save\";\r\n     }\r\n    else{\r\n      this.isRead = true;\r\n      this.buttonText = \"Edit\";  \r\n      //set pickuptime\r\n      //change deleteDate in firestore      \r\n      this.time = new Date(this.time);\r\n      this.pDate = new Date(this.pDate);\r\n      let newDate = new Date(this.pDate.getFullYear(), this.pDate.getMonth(), this.pDate.getDate(),this.time.getHours(), this.time.getMinutes(), this.time.getSeconds(), this.time.getMilliseconds())\r\n      console.log(newDate)\r\n\r\n      const data = {\r\n        description: listing.description,\r\n        listingID: listing.listingID,\r\n        price: listing.price,\r\n        quantity: listing.quantity,\r\n        retailerType: this.retailerType,\r\n        location: this.location,\r\n        retailerUID: this.retailerUID,\r\n        deleteDate: new Date(this.pDate.getFullYear(), this.pDate.getMonth(), this.pDate.getDate(), this.time.getHours(), this.time.getMinutes(), this.time.getSeconds(), this.time.getMilliseconds())\r\n      }\r\n  \r\n      this.afstore.collection(\"listings\").doc(this.listingID).set(data);\r\n      this.pickupTime = newDate.toLocaleString();\r\n      \r\n\r\n      \r\n    }   \r\n  }\r\n \r\n\r\n}\r\n"]}