{"version":3,"sources":["webpack:///src/app/retailertab3/retailertab3.page.html","webpack:///src/app/retailertab3/format-file-size.pipe.ts","webpack:///src/app/retailertab3/retailertab3-routing.module.ts","webpack:///src/app/retailertab3/retailertab3.module.ts","webpack:///src/app/retailertab3/retailertab3.page.scss","webpack:///src/app/retailertab3/retailertab3.page.ts"],"names":["FILE_SIZE_UNITS","FILE_SIZE_UNITS_LONG","FormatFileSizePipe","sizeInBytes","longForm","units","power","Math","round","log","min","length","size","pow","formattedSize","unit","name","routes","path","component","Retailertab3PageRoutingModule","imports","forChild","exports","Retailertab3PageModule","declarations","Retailertab3Page","nacCtrl","activatedRoute","firestore","afStorage","afAuth","loadingController","changeDetection","emailComposer","alertController","buttonText","isRead","isReady","isVerified","isFileUploading","isFileUploaded","filesCollection","collection","files","valueChanges","presentLoading","self","onAuthStateChanged","user","userUID","uid","doc","get","toPromise","userRef","data","retailerType","retailerUID","email","storageRef","ref","getDownloadURL","then","url","error","console","message","detectChanges","navigateRoot","Email","send","SecureToken","To","From","Subject","Body","alert","presentAlertCheck","emailConfirmation","newEmail","to","subject","body","isHtml","isAvailable","available","open","promise","Promise","resolve","resolveFunction","create","header","buttons","text","handler","present","trim","update","duration","translucent","cssClass","backdropDismiss","loading","onDidDismiss","role","event","file","item","type","split","imgName","fileStoragePath","imageRef","fileUploadTask","upload","percentageVal","percentageChanges","trackSnapshot","snapshotChanges","pipe","UploadedImageURL","subscribe","resp","storeFilesFirebase","filepath","imgSize","snap","totalBytes","image","set","res","err","selector","template"],"mappings":"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","file":"retailertab3-retailertab3-module-es5.js","sourcesContent":["export default \"<ion-header style=\\\"text-align: center\\\">\\r\\n  <ion-toolbar color=\\\"primary\\\" mode=\\\"ios\\\">\\r\\n    <ion-title>\\r\\n      Good Food\\r\\n    </ion-title>\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-menu-button autoHide=\\\"true\\\"></ion-menu-button>\\r\\n    </ion-buttons>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content [hidden]=\\\"!isReady\\\" fullscreen>  \\r\\n  <img [src]=\\\"url\\\" style=\\\"width:100%;\\\"> \\r\\n  <h1 style=\\\"text-align: center;\\\"> {{ name }} </h1>\\r\\n\\r\\n  <div id=\\\"container\\\" *ngIf=\\\"!isRead\\\">\\r\\n\\r\\n    <div class=\\\"ion-text-center\\\" *ngIf=\\\"!isUploading && !isUploaded\\\">\\r\\n      \\r\\n        <h2>Image Upload</h2>\\r\\n      \\r\\n        <ion-button class=\\\"ion-text-center\\\" color=\\\"primary\\\" style=\\\"width: 100%\\\">\\r\\n          <input type=\\\"file\\\" (change)=\\\"uploadImage($event.target.files)\\\" />\\r\\n        </ion-button>\\r\\n      </div>\\r\\n     \\r\\n\\r\\n    <!-- File upload progress bar -->\\r\\n    <!-- <div *ngIf=\\\"percentageVal | async as percentage\\\">\\r\\n      Progress: {{ percentage | number }}%\\r\\n      <ion-progress-bar value=\\\"{{ percentage / 100 }}\\\"></ion-progress-bar>\\r\\n    </div>\\r\\n\\r\\n    <div *ngIf=\\\"trackSnapshot | async as snap\\\">\\r\\n      File size: {{ snap.totalBytes | formatFileSize }} \\r\\n      \\r\\n      Data transfered: {{ snap.bytesTransferred | formatFileSize }}\\r\\n    </div>     -->\\r\\n\\r\\n  </div>\\r\\n \\r\\n  <ion-item >    \\r\\n    <ion-label>\\r\\n      Retailer Name:\\r\\n    </ion-label>\\r\\n    <ion-textarea placeholder=\\\"{{ name }}\\\" [readonly]=\\\"isRead\\\" [(ngModel)]=\\\"name\\\" ></ion-textarea>\\r\\n  </ion-item>\\r\\n\\r\\n   <ion-item >    \\r\\n        <ion-label>\\r\\n          Retailer UID:\\r\\n        </ion-label>\\r\\n        <ion-textarea placeholder=\\\"{{ retailerUID }}\\\" [readonly]=true  ></ion-textarea>\\r\\n    </ion-item>\\r\\n\\r\\n     <ion-item >    \\r\\n        <ion-label>\\r\\n          Retailer Email Address:\\r\\n        </ion-label>\\r\\n        <ion-textarea placeholder=\\\"{{ email }}\\\" [readonly]=true  ></ion-textarea>\\r\\n    </ion-item>\\r\\n    \\r\\n    <div style=\\\"text-align: center\\\"> \\r\\n      <section >\\r\\n        <br>\\r\\n        <ion-button expand=\\\"block\\\" (click)=\\\"edit()\\\">{{buttonText}}</ion-button>\\r\\n      </section>\\r\\n      <section>\\r\\n        <ion-button expand=\\\"block\\\" (click)=\\\"updatePassword()\\\">Update Password</ion-button>\\r\\n      </section>\\r\\n      <section *ngIf=\\\"!isVerified\\\">\\r\\n        <ion-button expand=\\\"block\\\" (click)=\\\"sendEmail()\\\">Send Verification Email</ion-button>\\r\\n      </section>\\r\\n    </div>\\r\\n\\r\\n    \\r\\n</ion-content>\";","import {Pipe, PipeTransform} from '@angular/core';\r\n\r\nconst FILE_SIZE_UNITS = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\r\nconst FILE_SIZE_UNITS_LONG = ['Bytes', 'Kilobytes', 'Megabytes', 'Gigabytes', 'Pettabytes', 'Exabytes', 'Zettabytes', 'Yottabytes'];\r\n\r\n@Pipe({\r\n  name: 'formatFileSize'\r\n})\r\n\r\nexport class FormatFileSizePipe implements PipeTransform {\r\n  transform(sizeInBytes: number, longForm: boolean): string {\r\n    const units = longForm\r\n      ? FILE_SIZE_UNITS_LONG\r\n      : FILE_SIZE_UNITS;\r\n    let power = Math.round(Math.log(sizeInBytes)/Math.log(1024));\r\n  \tpower = Math.min(power, units.length - 1);\r\n  \tconst size = sizeInBytes / Math.pow(1024, power); // size in new units\r\n  \tconst formattedSize = Math.round(size * 100) / 100; // keep up to 2 decimals\r\n  \tconst unit = units[power];\r\n  \treturn `${formattedSize} ${unit}`;\r\n  }\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { Retailertab3Page } from './retailertab3.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: Retailertab3Page\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class Retailertab3PageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { Retailertab3PageRoutingModule } from './retailertab3-routing.module';\r\n\r\nimport { Retailertab3Page } from './retailertab3.page';\r\n\r\nimport { FormatFileSizePipe } from './format-file-size.pipe';\r\n\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    Retailertab3PageRoutingModule\r\n  ],\r\n  declarations: [\r\n    Retailertab3Page,\r\n    FormatFileSizePipe\r\n  ]\r\n})\r\nexport class Retailertab3PageModule {}\r\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3JldGFpbGVydGFiMy9yZXRhaWxlcnRhYjMucGFnZS5zY3NzIn0= */\";","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { AngularFirestore, AngularFirestoreCollection } from '@angular/fire/firestore';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { AngularFireAuth } from '@angular/fire/auth';\r\nimport * as firebase from 'firebase/app';\r\nimport { LoadingController, NavController, AlertController } from '@ionic/angular';\r\nimport { Observable } from 'rxjs';\r\nimport { finalize, tap } from 'rxjs/operators';\r\nimport { AngularFireStorage, AngularFireUploadTask } from '@angular/fire/storage';\r\nimport { EmailComposer } from '@ionic-native/email-composer/ngx';\r\n\r\ndeclare var Email: any;\r\n\r\nexport interface imgFile {\r\n  name: string;\r\n  filepath: string;\r\n  size: number;\r\n}\r\n\r\n@Component({\r\n  selector: 'app-retailertab3',\r\n  templateUrl: './retailertab3.page.html',\r\n  styleUrls: ['./retailertab3.page.scss'],\r\n})\r\nexport class Retailertab3Page implements OnInit {\r\n  userRef;\r\n  userUID;\r\n  retailerType;\r\n  retailerUID;\r\n  name;\r\n  email;\r\n  url;\r\n  buttonText: string = \"Edit\";\r\n  isRead: boolean = true;\r\n  isReady: boolean = false;\r\n  isVerified: boolean = false;\r\n\r\n  // File upload task \r\n  fileUploadTask: AngularFireUploadTask;\r\n\r\n  // Upload progress\r\n  percentageVal: Observable<number>;\r\n\r\n  // Track file uploading with snapshot\r\n  trackSnapshot: Observable<any>;\r\n\r\n  // Uploaded File URL\r\n  UploadedImageURL: Observable<string>;\r\n\r\n  // Uploaded image collection\r\n  files: Observable<imgFile[]>;\r\n\r\n  // Image specifications\r\n  imgName: string;\r\n  imgSize: number;\r\n\r\n  // File uploading status\r\n  isFileUploading: boolean;\r\n  isFileUploaded: boolean;\r\n\r\n  private filesCollection: AngularFirestoreCollection<imgFile>;\r\n  \r\n  constructor(public nacCtrl: NavController, private activatedRoute: ActivatedRoute, private firestore: AngularFirestore, private afStorage: AngularFireStorage, public afAuth: AngularFireAuth, public loadingController: LoadingController, private changeDetection: ChangeDetectorRef, public emailComposer: EmailComposer,  public alertController: AlertController) {\r\n    this.isFileUploading = false;\r\n    this.isFileUploaded = false;\r\n    \r\n    // Define uploaded files collection\r\n    this.filesCollection = firestore.collection<imgFile>('imagesCollection');\r\n    this.files = this.filesCollection.valueChanges();\r\n  \r\n   }\r\n  \r\n  async ngOnInit() {\r\n   this.presentLoading()\r\n    try{\r\n    var self = this;\r\n    await (firebase.auth().onAuthStateChanged(async function(user) {  \r\n      \r\n      if (user) {        \r\n        self.userUID = user.uid\r\n\r\n          self.userRef = (await self.firestore.collection(\"users\").doc(self.userUID).get().toPromise()).data()\r\n              self.retailerType = self.userRef.retailerType;\r\n              self.retailerUID = self.userRef.retailerUID;    \r\n              self.email = self.userRef.email;\r\n              self.name = self.userRef.name;\r\n              self.isVerified = self.userRef.isVerified;\r\n\r\n          var storageRef =  self.afStorage.ref(`images/${self.userUID}`).getDownloadURL().toPromise().then(function(url) {        \r\n              self.url = url; \r\n          }).catch(function(error) {\r\n            self.url = 'assets/images/default.png';\r\n          });\r\n           \r\n      }\r\n      else{\r\n        console.log('no user signed in');\r\n      }\r\n    }));    \r\n      \r\n  }\r\n  catch(error){\r\n    console.log(error.message)\r\n  }\r\n}\r\n\r\nasync ionViewWillEnter(){\r\n  if(this.userUID){  \r\n  const userRef = (await this.firestore.collection(\"users\").doc(this.userUID).get().toPromise()).data();\r\n    this.isVerified = userRef.isVerified;\r\n    this.changeDetection.detectChanges(); \r\n    this.isReady = true; \r\n  } \r\n}  \r\n\r\n\r\nupdatePassword(){        \r\n  this.nacCtrl.navigateRoot(['./retailer-update-password'])\r\n}\r\n\r\nsendEmail(){        \r\n  Email.send({\r\n    SecureToken : \"c11c8a65-d4f9-45b7-8c2a-61f9c48e0ea7\",\r\n    To : 'goodfoodinnova@gmail.com',\r\n    From : 'goodfoodinnova@gmail.com',\r\n    Subject : \"New Retailer Verification Reminder\",\r\n    Body : 'Hello, please verify retailer: ' + this.name + ' with email: ' + this.email + ' and uid: ' + this.retailerUID + '. Thank you!'\r\n  }).then(\r\n    async message => { \r\n      if(message == \"OK\"){\r\n        console.log(message)\r\n        alert(\"A message has been sent to ensure your account is verified!\")\r\n      }\r\n      else{\r\n        console.log(\"SMTP.js Error: \" + message)\r\n          const emailConfirmation = await this.presentAlertCheck();\r\n\r\n          if (emailConfirmation) {\r\n\r\n          let newEmail = {\r\n            to: 'goodfoodinnova@gmail.com',\r\n            subject: 'New Retailer Verification',\r\n            body: 'Hello, please verify retailer: ' + this.name + ' with email: ' + this.email + ' and uid: ' + this.retailerUID + '. Thank you!',\r\n            isHtml: true,\r\n          }\r\n\r\n          this.emailComposer.isAvailable().then((available: boolean) => {\r\n            if(available) {\r\n              console.log(\"isAvailable\");\r\n            }\r\n          }).catch((error) => { console.log('EmailComposer Error: ' + error.message) });\r\n          this.emailComposer.open(newEmail);\r\n        }\r\n      }         \r\n    \r\n  });    \r\n}\r\n\r\npublic async presentAlertCheck() : Promise<boolean> {\r\n  let resolveFunction: (confirm: boolean) => void;\r\n  const promise = new Promise<boolean>(resolve => {\r\n    resolveFunction = resolve;\r\n  });\r\n  \r\n  const alert = await this.alertController.create({\r\n    header: 'Confirm Navigation',\r\n    message: 'You are about to be navigated out of this application. Click OK to continue.',\r\n    buttons: [\r\n      {\r\n        text: 'OK',\r\n          handler: () => resolveFunction(true)\r\n      }\r\n    ]\r\n  });\r\n\r\n  await alert.present();\r\n  return promise;\r\n}\r\n\r\n\r\nedit() {\r\n  console.log(\"clicked edit\")\r\n  console.log(this.buttonText)\r\n  console.log(this.isRead)\r\n    if(this.buttonText == \"Edit\"){\r\n      this.isRead = false;\r\n      console.log(\"entered if\")\r\n      this.buttonText = \"Save\";\r\n      this.changeDetection.detectChanges(); \r\n      \r\n     }\r\n    else{\r\n      this.isRead = true;\r\n      this.buttonText = \"Edit\";\r\n\r\n      let self = this;\r\n\r\n    var storageRef =  this.afStorage.ref(`images/${this.userUID}`).getDownloadURL().toPromise().then(function(url) {        \r\n        self.url = url; \r\n    }).catch(function(error) {\r\n      self.url = 'assets/images/default.png';\r\n    });\r\n\r\n      this.changeDetection.detectChanges();       \r\n      \r\n      const { name } = this\r\n      if(name.trim().length != 0){\r\n        try{\r\n          this.firestore.doc(`users/${this.userUID}`).update({          \r\n            name               \r\n          })\r\n        }catch(error){  \r\n          console.log(error.message)\r\n        }   \r\n      }else {\r\n       alert(\"Please enter a value for name\");       \r\n      }  \r\n      \r\n    }   \r\n  }\r\n\r\n  async presentLoading() {\r\n    const loading = await this.loadingController.create({\r\n      duration: 900,\r\n      translucent: true,\r\n      cssClass: 'transparent',\r\n      backdropDismiss: false\r\n    });\r\n    await loading.present();\r\n\r\n    const { role, data } = await loading.onDidDismiss();\r\n    this.isReady = true;\r\n    this.changeDetection.detectChanges(); \r\n  }\r\n\r\n  \r\n  uploadImage(event: FileList) {\r\n      \r\n    const file = event.item(0)\r\n\r\n    // Image validation\r\n    if (file.type.split('/')[0] !== 'image') { \r\n      alert('File type is not supported!')\r\n      return;\r\n    }\r\n\r\n    this.isFileUploading = true;\r\n    this.isFileUploaded = false;\r\n\r\n    this.imgName = this.retailerUID;\r\n\r\n    // Storage path\r\n    const fileStoragePath = `images/${this.imgName}`;\r\n\r\n    // Image reference\r\n    const imageRef = this.afStorage.ref(fileStoragePath);\r\n\r\n    // File upload task\r\n    this.fileUploadTask = this.afStorage.upload(fileStoragePath, file);\r\n\r\n    // Show uploading progress\r\n    this.percentageVal = this.fileUploadTask.percentageChanges();\r\n    this.trackSnapshot = this.fileUploadTask.snapshotChanges().pipe(\r\n      \r\n      finalize(() => {\r\n        // Retreive uploaded image storage path\r\n        this.UploadedImageURL = imageRef.getDownloadURL();\r\n        \r\n        this.UploadedImageURL.subscribe(resp=>{\r\n          this.storeFilesFirebase({\r\n            name: this.retailerUID,\r\n            filepath: resp,\r\n            size: this.imgSize\r\n          });\r\n          this.isFileUploading = false;\r\n          this.isFileUploaded = true;\r\n        },error=>{\r\n          console.log(error);\r\n        })\r\n      }),\r\n      tap(snap => {\r\n          this.imgSize = snap.totalBytes;\r\n      })\r\n    )\r\n}\r\n\r\n\r\nstoreFilesFirebase(image: imgFile) {\r\n    //const fileId = this.afstore.createId();\r\n    \r\n    this.filesCollection.doc(this.retailerUID).set(image).then(res => {\r\n      console.log(res);\r\n    }).catch(err => {\r\n      console.log(err);\r\n    });\r\n}\r\n\r\n\r\n}"]}