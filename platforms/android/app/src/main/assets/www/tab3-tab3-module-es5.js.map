{"version":3,"sources":["webpack:///src/app/tab3/tab3.page.html","webpack:///src/app/tab3/tab3-routing.module.ts","webpack:///src/app/tab3/tab3.module.ts","webpack:///src/app/tab3/tab3.page.scss","webpack:///src/app/tab3/tab3.page.ts"],"names":["routes","path","component","Tab3PageRoutingModule","imports","forChild","exports","Tab3PageModule","declarations","Tab3Page","listingService","afauth","nacCtrl","afstore","changeDetection","alertCtrl","cart","subtotal","isReady","self","onAuthStateChanged","user","userUID","uid","items","doc","userItems","valueChanges","initializeItems","retailers","getUsers","filter","currentUser","isRetailer","detectChanges","getCart","currentListing","get","toPromise","then","querySnapshot","cart1","forEach","element","push","totalPrice","error","console","log","item","presentAlertDelete","confirm","update","FieldValue","arrayRemove","description","listingID","retailerUID","quantity","quantityCart","price","toLowerCase","promise","Promise","resolve","resolveFunction","create","header","message","buttons","text","handler","alert","present","quantityValue","priceValue","arrayUnion","find","name","presentAlertCheck","navigateRoot","selector","template"],"mappings":"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","file":"tab3-tab3-module-es5.js","sourcesContent":["export default \"<ion-header style=\\\"text-align: center\\\">\\r\\n  <ion-toolbar mode=\\\"ios\\\" color=\\\"primary\\\">\\r\\n    <ion-title>Good Food</ion-title>\\r\\n    <ion-buttons slot=\\\"start\\\">\\r\\n      <ion-menu-button autoHide=\\\"true\\\"></ion-menu-button>\\r\\n    </ion-buttons>\\r\\n  </ion-toolbar>\\r\\n</ion-header>\\r\\n\\r\\n<ion-content fullscreen [hidden]=\\\"!isReady\\\">\\r\\n  <div *ngFor=\\\"let item of cart\\\">\\r\\n    <ion-card>\\r\\n     <ion-item>\\r\\n      <ion-card-title class=\\\"ion-text-wrap\\\">{{getRetailer(item.retailerUID)}}</ion-card-title>\\r\\n      <ion-button  (click)=\\\"delete(item)\\\" fill=\\\"outline\\\" slot=\\\"end\\\">Delete</ion-button> \\r\\n    </ion-item>\\r\\n   \\r\\n     <ion-card-content> \\r\\n        <p style=\\\"font-size: large;\\\" > Quantity: \\r\\n          <ion-button (click)=\\\"dec(item)\\\" size=\\\"small\\\" fill=\\\"clear\\\"> \\r\\n            <ion-icon name=\\\"remove-circle-outline\\\"></ion-icon> \\r\\n          </ion-button>\\r\\n          {{item.quantityCart}}\\r\\n          <ion-button (click)=\\\"inc(item)\\\" size=\\\"small\\\" fill=\\\"clear\\\"> \\r\\n            <ion-icon name=\\\"add-circle-outline\\\"></ion-icon> \\r\\n          </ion-button></p>\\r\\n          <p style=\\\"font-size: large;\\\"> Price: ${{item.totalPrice | number:'1.2-2'}}</p>\\r\\n     </ion-card-content>\\r\\n   </ion-card>\\r\\n  </div>\\r\\n  <ion-text class=\\\"centerText\\\" *ngIf=\\\"((userItems | async)?.cart).length <= 0\\\" color=\\\"primary\\\" style=\\\"text-align: center\\\">\\r\\n      <p>There are no items in the cart.</p>\\r\\n  </ion-text>  \\r\\n</ion-content>\\r\\n\\r\\n<ion-footer *ngIf=\\\"((userItems | async)?.cart).length > 0\\\" >\\r\\n  <!-- class=\\\"ion-no-border\\\" -->\\r\\n \\r\\n  <ion-toolbar *ngIf=\\\"userItems | async as cartData\\\"  position=\\\"bottom\\\" style=\\\"text-align: center;\\\">\\r\\n    <div class=\\\"ion-text-end\\\" id=\\\"subtotal\\\">\\r\\n      <ion-text > <p style=\\\"font-size: large;\\\"> Subtotal: ${{subtotal | number:'1.2-2'}} </p></ion-text> \\r\\n    </div>     \\r\\n    <ion-button expand=\\\"block\\\" (click)=\\\"checkOut(cartData.cart)\\\" size=\\\"large\\\">Checkout</ion-button>\\r\\n </ion-toolbar>\\r\\n</ion-footer>\\r\\n\";","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { Tab3Page } from './tab3.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: Tab3Page,\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class Tab3PageRoutingModule {}\n","import { IonicModule } from '@ionic/angular';\r\nimport { RouterModule } from '@angular/router';\r\nimport { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { Tab3Page } from './tab3.page';\r\n\r\nimport { Tab3PageRoutingModule } from './tab3-routing.module'\r\n\r\n@NgModule({\r\n  imports: [\r\n    IonicModule,\r\n    CommonModule,\r\n    FormsModule,\r\n    RouterModule.forChild([{ path: '', component: Tab3Page }]),\r\n    Tab3PageRoutingModule,\r\n  ],\r\n  declarations: [Tab3Page]\r\n})\r\nexport class Tab3PageModule {}\r\n","export default \".large {\\n  font-size: 1500%;\\n}\\n\\n.centerText {\\n  height: 90% !important;\\n  display: flex !important;\\n  align-items: center !important;\\n  justify-content: center !important;\\n  align-content: center !important;\\n  flex-wrap: wrap !important;\\n}\\n\\n#subtotal {\\n  padding-right: 2%;\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9hcHAvdGFiMy90YWIzLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGdCQUFBO0FBQ0o7O0FBRUE7RUFDSSxzQkFBQTtFQUNBLHdCQUFBO0VBQ0EsOEJBQUE7RUFDQSxrQ0FBQTtFQUNBLGdDQUFBO0VBQ0EsMEJBQUE7QUFDSjs7QUFFQztFQUNHLGlCQUFBO0FBQ0oiLCJmaWxlIjoic3JjL2FwcC90YWIzL3RhYjMucGFnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmxhcmdle1xyXG4gICAgZm9udC1zaXplOiAxNTAwJTtcclxufVxyXG5cclxuLmNlbnRlclRleHQge1xyXG4gICAgaGVpZ2h0OiA5MCUgIWltcG9ydGFudDtcclxuICAgIGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDtcclxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXIgIWltcG9ydGFudDtcclxuICAgIGp1c3RpZnktY29udGVudDogY2VudGVyICFpbXBvcnRhbnQ7XHJcbiAgICBhbGlnbi1jb250ZW50OiBjZW50ZXIhaW1wb3J0YW50O1xyXG4gICAgZmxleC13cmFwOiB3cmFwICFpbXBvcnRhbnQ7ICAgIFxyXG4gfVxyXG5cclxuICNzdWJ0b3RhbHtcclxuICAgIHBhZGRpbmctcmlnaHQ6IDIlO1xyXG4gfVxyXG5cclxuIl19 */\";","import { ChangeDetectorRef, Component, OnInit } from '@angular/core';\r\nimport { AngularFirestore } from '@angular/fire/firestore';\r\nimport { AngularFireAuth } from '@angular/fire/auth';\r\nimport { AlertController, NavController } from '@ionic/angular';\r\nimport * as firebase from 'firebase/app';\r\nimport { ListingsService} from '../listings.service';\r\n\r\n@Component({\r\n  selector: 'app-tab3',\r\n  templateUrl: 'tab3.page.html',\r\n  styleUrls: ['tab3.page.scss']\r\n})\r\nexport class Tab3Page implements OnInit{\r\n  userUID;\r\n  userItems;\r\n  items;\r\n  cart = [];\r\n  listing;\r\n  name;\r\n  description;\r\n  location;\r\n  price;\r\n  quantity;\r\n  retailerType;\r\n  retailerUID;\r\n  date: Date;\r\n  subtotal = 0;\r\n  isReady = false;\r\n  retailers: any[];\r\n\r\n  constructor(public listingService: ListingsService, public afauth: AngularFireAuth, private nacCtrl: NavController, public afstore: AngularFirestore, private changeDetection: ChangeDetectorRef, public alertCtrl: AlertController) {}\r\n\r\n  ngOnInit() { \r\n    var self = this\r\n    this.cart = []\r\n    this.subtotal = 0;\r\n    this.afauth.onAuthStateChanged(async function(user) {        \r\n      if (user) {        \r\n        self.userUID = user.uid\r\n        self.items = self.afstore.doc(`users/${self.userUID}`);\r\n        self.userItems = self.items.valueChanges();\r\n        await self.listingService.initializeItems();\r\n        self.retailers = self.listingService.getUsers().filter(currentUser => {\r\n          if (currentUser.isRetailer) {\r\n            return (currentUser.isRetailer);\r\n          }\r\n        });   \r\n        self.changeDetection.detectChanges(); \r\n        self.getCart();  \r\n\r\n      }\r\n    });    \r\n  }\r\n\r\n  async ionViewWillEnter(){\r\n    this.cart = []\r\n    this.subtotal = 0;\r\n    if(this.items){\r\n      this.userItems = this.items.valueChanges();\r\n      await this.listingService.initializeItems();\r\n      this.retailers = this.listingService.getUsers().filter(currentListing => {\r\n        if (currentListing.isRetailer) {\r\n          return (currentListing.isRetailer);\r\n        }\r\n      }); \r\n      this.getCart();\r\n      this.changeDetection.detectChanges(); \r\n\r\n      \r\n    }    \r\n  }\r\n\r\n  async getCart(){    \r\n    var self = this;\r\n    await this.afstore.doc(`users/${this.userUID}`).get().toPromise().then(function(querySnapshot) {\r\n      self.cart = []\r\n      self.subtotal = 0\r\n      var cart1 = querySnapshot.get(\"cart\");\r\n      self.changeDetection.detectChanges(); \r\n      cart1.forEach(element => {\r\n        self.cart.push(element);  \r\n        self.subtotal += element.totalPrice          \r\n        });            \r\n    })\r\n    .catch(function(error) {\r\n        console.log(\"Error getting documents\");\r\n    }); \r\n\r\n    this.changeDetection.detectChanges();  \r\n    this.isReady = true;   \r\n  }\r\n\r\n  async delete(item){\r\n\r\n    const confirm = await this.presentAlertDelete();\r\n    if (confirm) {\r\n    this.afstore.doc(`users/${this.userUID}`).update({\r\n      cart: firebase.firestore.FieldValue.arrayRemove({\r\n        description: item.description,\r\n        listingID: item.listingID,\r\n        retailerUID: item.retailerUID,\r\n        quantity: item.quantity,\r\n        quantityCart: item.quantityCart,\r\n        price: item.price,\r\n        totalPrice: item.totalPrice\r\n      })\r\n    })\r\n    this.cart = this.cart.filter(currentListing => {\r\n      if (currentListing.listingID && item.listingID) {\r\n        return (!(currentListing.listingID.toLowerCase() === item.listingID.toLowerCase()));\r\n      }\r\n    }); \r\n    this.subtotal -= item.totalPrice; \r\n  }\r\n  }\r\n\r\n  async presentAlertDelete() : Promise<boolean> {\r\n    let resolveFunction: (confirm: boolean) => void;\r\n    const promise = new Promise<boolean>(resolve => {\r\n      resolveFunction = resolve;\r\n    });\r\n    const alert = await this.alertCtrl.create({\r\n      header: 'Confirm Delete',\r\n      message: 'Are you sure you want to delete this item from your cart?',\r\n      buttons: [\r\n        {\r\n          text: 'Yes',\r\n            handler: () => resolveFunction(true)\r\n        }, {\r\n          text: 'No',\r\n          handler: () => resolveFunction(false)\r\n        }\r\n      ]\r\n    });\r\n\r\n    await alert.present();\r\n    return promise;\r\n  }\r\n\r\n  inc(item){   \r\n    if(item.quantityCart + 1 <= item.quantity){\r\n\r\n      var quantityValue = item.quantityCart + 1; \r\n      var priceValue = item.totalPrice + item.price;\r\n\r\n      this.afstore.doc(`users/${this.userUID}`).update({\r\n        cart: firebase.firestore.FieldValue.arrayUnion({\r\n          description: item.description,\r\n          listingID: item.listingID,\r\n          retailerUID: item.retailerUID,\r\n          quantity: item.quantity,\r\n          quantityCart: quantityValue,\r\n          price: item.price,\r\n          totalPrice: priceValue\r\n        })\r\n      })\r\n  \r\n      this.afstore.doc(`users/${this.userUID}`).update({\r\n        cart: firebase.firestore.FieldValue.arrayRemove({\r\n          description: item.description,\r\n          listingID: item.listingID,\r\n          retailerUID: item.retailerUID,\r\n          quantity: item.quantity,\r\n          quantityCart: item.quantityCart,\r\n          price: item.price,\r\n          totalPrice: item.totalPrice\r\n        })\r\n      })\r\n      item.quantityCart++;\r\n      item.totalPrice += item.price;\r\n      this.subtotal += item.price;\r\n      \r\n    }  \r\n  }\r\n\r\n  dec(item){    \r\n    if(item.quantityCart - 1 > 0){\r\n      var quantityValue = item.quantityCart - 1;  \r\n      var priceValue = item.totalPrice - item.price;\r\n\r\n      this.afstore.doc(`users/${this.userUID}`).update({\r\n        cart: firebase.firestore.FieldValue.arrayUnion({\r\n          description: item.description,\r\n          listingID: item.listingID,\r\n          retailerUID: item.retailerUID,\r\n          quantity: item.quantity,\r\n          quantityCart: quantityValue,\r\n          totalPrice: priceValue,\r\n          price: item.price\r\n        })\r\n      })\r\n  \r\n      this.afstore.doc(`users/${this.userUID}`).update({\r\n        cart: firebase.firestore.FieldValue.arrayRemove({\r\n          description: item.description,\r\n          listingID: item.listingID,\r\n          retailerUID: item.retailerUID,\r\n          quantity: item.quantity,\r\n          quantityCart: item.quantityCart,\r\n          price: item.price,\r\n          totalPrice: item.totalPrice\r\n        })\r\n      })\r\n      item.quantityCart--;\r\n      item.totalPrice -= item.price;\r\n      this.subtotal -= item.price;\r\n    }\r\n  }\r\n\r\n\r\n  getRetailer(uid) : String{  \r\n    if(this.retailers){\r\n     const user = this.retailers.find(element => element.retailerUID == uid);    \r\n     return user.name;\r\n\r\n    }\r\n  }\r\n\r\n  async checkOut(cart){\r\n    const confirm = await this.presentAlertCheck();\r\n    if (confirm) {\r\n      this.nacCtrl.navigateRoot(['./paypal']);\r\n    }   \r\n  }\r\n\r\n  public async presentAlertCheck() : Promise<boolean> {\r\n    let resolveFunction: (confirm: boolean) => void;\r\n    const promise = new Promise<boolean>(resolve => {\r\n      resolveFunction = resolve;\r\n    });\r\n    const alert = await this.alertCtrl.create({\r\n      header: 'Confirm Check-Out',\r\n      message: 'Are you sure you want to check out these items from your cart?',\r\n      buttons: [\r\n        {\r\n          text: 'No',\r\n          handler: () => resolveFunction(false)\r\n        },\r\n        {\r\n          text: 'Yes',\r\n            handler: () => resolveFunction(true)\r\n        }\r\n      ]\r\n    });\r\n\r\n    await alert.present();\r\n    return promise;\r\n  }\r\n}\r\n"]}